<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Android Perofrmance</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Android Perofrmance">
<meta property="og:url" content="http://androidperformance.com/page/2/index.html">
<meta property="og:site_name" content="Android Perofrmance">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android Perofrmance">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Android Perofrmance" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Gracker</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Gracker</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="">
				<hgroup>
				  <h1 class="header-author">Gracker</h1>
				</hgroup>
			</div>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-android-performance-optimization-overdraw-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/20/android-performance-optimization-overdraw-1/" class="article-date">
  	<time datetime="2014-10-20T15:19:23.000Z" itemprop="datePublished">2014-10-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/20/android-performance-optimization-overdraw-1/">Android性能优化之过渡绘制(一)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>博客有一段时间没有更新了，到了新公司后，一直比较忙，博客也更新地不那么频繁了，倒是利用这个VPS搭建的VPN每天都在用，速度也蛮不错的。最近一直在看Android上和性能相关的部分，也就是所谓的Android性能优化，才发现Android性能这一块，自己懂得还是太少了，所以从上层开始看，也算是一点一点入门吧。这个系列将讲解学习过程中总结的和性能相关的内容。</p>
<p>首先将讲解一下GPU过渡绘制，也是开发者最直接接触的部分吧，这个内容将分为两个部分来将讲，第一部分初步讲解一下gpu过渡绘制的原理，和一些优化建议，第二部分将用实际例子来讲解优化GPU过渡绘制的一般步骤。</p>
<p><strong>1. 过渡绘制概念:</strong></p>
<p>GPU过渡绘制的概念：GPU过度绘制指的是在屏幕一个像素上绘制多次(超过一次),比如一个TextView后有背景，那么显示文本的像素至少绘了两次，一次是背景，一次是文本。GPU过度绘制或多或少对性能有些影响,设备的内存带宽是有限的，当过度绘制导致应用需要更多的带宽(超过了可用带宽)的时候性能就会降低。带宽的限制每个设备都可能是不一样的。</p>
<p><strong>2. 过渡绘制的原因:</strong></p>
<p>1. 太多的View叠加</p>
<p>2. 复杂的层级叠加</p>
<p>3. 更长的inflation时间</p>
<p><strong>3. 过渡绘制和不合理的xml布局的影响:</strong></p>
<p>1. 布局文件是一个xml文件，inflate布局文件其实就是解析xml，根据标签信息创建相应的布局对象并做关联。xml中的标签和属性设置越多，节点树的深度越深，在解析时要执行的判断逻辑、函数的嵌套和递归就越多，所以时间消耗越多；</p>
<p>2. inflate操作只是布局影响的第一个环节，一个界面要显示出来，在requestLayout后还要执行一系列的measure、layout、draw的操作，每一步的执行时间都会受到布局本身的影响。而界面的最终显示是所有这些操作完成后才实现的，所以如果布局质量差，会增加每一步操作的时间成本，最终显示时间就会比较长。</p>
<p><strong>4. 优化工具介绍:Android提供了三个工具来帮助辨别和解决重绘问题：Hierachy Viewer，Tracer for OpenGL和Show GPU overdraw。前两个可以在ADT工具或者独立的monitor工具中找到，最后一个是在开发者选项的一部分。</strong></p>
<p>1. GPU过渡绘制:对于过度绘制的测试主要通过人工进行测试，也是发现应用过渡绘制的首选途径 .通过打开开发者选项中的 显示GPU过度绘制(魅族手机:设置—辅助功能—开发人员工具—硬件加速渲染—调试GPU过渡绘制— 显示过渡绘制区域. (魅族手机需要打开开发者模式：需要在电话界面输入: <em>#</em>#6961#<em>#</em> )) 来进行测试（PS：只有android4.2及以上的版本才具备此功能)</p>
<p>1. 颜色标识: 从好到差:蓝-绿-淡红-红</p>
<p>1. 蓝色1x过度绘制<br>2. 绿色2x过度绘制<br>3. 淡红色3x过度绘制<br>4. 红色超过4x过度绘制</p>
<p>2. 验收标准:</p>
<p>1. 控制过度绘制为2x<br>2. 不允许存在4x过度绘制<br>3. 不允许存在面积超过屏幕1/4区域的3x过度绘制（淡红色区域）</p>
<p>3. Lint工具:</p>
<p><a href="\"><img src="\" alt="\"></a></p>
<p>1. Eclipse中,点击即可,下面的窗口中会出现提示,根据提示和具体解决办法消除.<br>2. Android Studio自带Lint工具,不合理或者需要优化和注意的地方,会用黄色标记出来.<br>3. Lint工具不仅对布局有很好的优化建议,对代码中不合理的活着存在潜在风险的模块也会提出优化建议,所以一个好的建议是:多使用Lint工具检查自己的应用,尽量消除所有的建议.<br>4. Lint工具可以用命令行来运行,具体使用可以参考:tools.android.com<br>5. Lint工具的提升例子(摘自官方文档):</p>
<p>1. Use compound drawables(使用compound drawables) - A LinearLayout which contains an ImageView and a TextView can be more efficiently handled as a compound drawable.<br>2. Merge root frame(使用Merge根框架) - If a FrameLayout is the root of a layout and does not provide background or padding etc, it can be replaced with a merge tag which is slightly more efficient.<br>3. Useless leaf(去除无用的分支) - A layout that has no children or no background can often be removed (since it is invisible) for a flatter and more efficient layout hierarchy.<br>4. Useless parent (去除无用的父控件)- A layout with children that has no siblings, is not a ScrollView or a root layout, and does not have a background, can be removed and have its children moved directly into the parent for a flatter and more efficient layout hierarchy.<br>5. Deep layouts (注意Layout的深度) - Layouts with too much nesting are bad for performance. Consider using flatter layouts such as RelativeLayout or GridLayout to improve performance. The default maximum depth is</p>
<p>4. Hierarchy Viewer:此工具是一个ADT工具（或者monitor,最新版本的SDK建议不使用独立的HV工具,而是直接在monitor中进行操作.）的一部分，可以被用作对视图层级进行快速解读。在处理布局问题时特别有用，对于性能问题也很适用。Hierarchy Viewer默认只能在非加密设备使用，例如工程机，工程平板或者模拟器。为了能够在任何手机上使用Hierarchy Viewer，你得在你的应用中添加ViewServer，这是一个开源库,使用方法可以参考这里。连接上设备，打开Hierarchy Viewer(定位到tools/目录下，直接执行hierarchyviewer的命令，选定需要查看的Process，再点击Load View Hierarchy会显示出当前界面的布局Tree。在每个模块的Traffic light上有三个灯，分别代表了Measure, Layout and Draw三个步骤的性能。</p>
<p><strong>5. 布局优化建议:</strong></p>
<p>1. 布局原则:在Android UI布局过程中，通过遵守一些惯用、有效的布局原则，我们可以制作出高效且复用性高的UI，概括来说包括如下几点：</p>
<p>1. 尽量多使用RelativeLayout和LinearLayout, 不要使用绝对布局AbsoluteLayout，</p>
<p>1. 在布局层次一样的情况下， 建议使用LinearLayout代替RelativeLayout, 因为LinearLayout性能要稍高一点.<br>2. 在完成相对较复杂的布局时,建议使用RelativeLayout,RelativeLayout可以简单实现LinearLayout嵌套才能实现的布局.</p>
<p>2. 将可复用的组件抽取出来并通过include标签使用；<br>3. 使用ViewStub标签来加载一些不常用的布局；<br>4. 动态地inflation view性能要比SetVisiblity性能要好.当然用VIewStub是最好的选择.<br>5. 使用merge标签减少布局的嵌套层次<br>6. 去掉多余的背景颜色(查看背景颜色是否多余,可以将HierarchyView中的图导出为psd文件,然后用Photoshop查看.具体可以参考这个视频(<a href="https://www.youtube.com/watch?v=URyoiAt8098" target="_blank" rel="external">https://www.youtube.com/watch?v=URyoiAt8098</a>))</p>
<p>1. 对于有多层背景颜色的Layout来说,留最上面一层的颜色即可,其他底层的颜色都可以去掉<br>2. 对于使用Selector当背景的Layout(比如ListView的Item,会使用Selector来标记点击,选择等不同的状态),可以将normal状态的color设置为\”@android:color/transparent”,来解决对应的问题</p>
<p>8. 内嵌使用包含layout_weight属性的LinearLayout会在绘制时花费昂贵的系统资源，因为每一个子组件都需要被测量两次。在使用ListView与GridView的时候，这个问题显的尤其重要，因为子组件会重复被创建.所以要尽量避免使用Layout_weight<br>9. 使得Layout宽而浅，而不是窄而深（在Hierarchy Viewer的Tree视图里面体现）</p>
<p><strong>6. 例子</strong></p>
<p><strong>1. 过渡绘制优化较好的应用</strong></p>
<p>设置 画板 录音机（魅族自带应用）:</p>
<p><a href="\"><img src="\" alt="\"></a>  <a href="\"><img src="\" alt="\"></a>  <a href="\"><img src="\" alt="\"></a></p>
<p><strong>2. 过渡绘制优化较严重的应用</strong></p>
<p><strong>文件管理器 图库 应用中心 音乐 视频等</strong></p>
<p><a href="\"><img src="\" alt="\"></a>  <a href="\"><img src="\" alt="\"></a>  <a href="\"><img src="\" alt="\"></a></p>
<p>另外一些第三方客户端的过渡绘制也很严重，见<a href="\">微博</a></p>
<p><img src="\" alt="\">            <img src="\" alt="\"></p>
<p>  <img src="\" alt="\">          <img src="\" alt="\"></p>
<p>另外有能力看源码的同学，下面是绘制OverDraw的源码位置：/frameworks/base/libs/hwui/OpenGLRenderer.cpp,有兴趣的可以去研究研究。</p>
<pre class="\"lang:java" decode:true="" \"="" title="\"CountOverDraw\"">void OpenGLRenderer::renderOverdraw() {
    if (mCaches.debugOverdraw &amp;&amp; getTargetFbo() == 0) {
        const Rect* clip = &amp;mTilingClip;

        mCaches.enableScissor();
        mCaches.setScissor(clip-&gt;left, mFirstSnapshot-&gt;height - clip-&gt;bottom,
                clip-&gt;right - clip-&gt;left, clip-&gt;bottom - clip-&gt;top);

        // 1x overdraw
        mCaches.stencil.enableDebugTest(2);
        drawColor(mCaches.getOverdrawColor(1), SkXfermode::kSrcOver_Mode);

        // 2x overdraw
        mCaches.stencil.enableDebugTest(3);
        drawColor(mCaches.getOverdrawColor(2), SkXfermode::kSrcOver_Mode);

        // 3x overdraw
        mCaches.stencil.enableDebugTest(4);
        drawColor(mCaches.getOverdrawColor(3), SkXfermode::kSrcOver_Mode);

        // 4x overdraw and higher
        mCaches.stencil.enableDebugTest(4, true);
        drawColor(mCaches.getOverdrawColor(4), SkXfermode::kSrcOver_Mode);

        mCaches.stencil.disable();
    }
}

void OpenGLRenderer::countOverdraw() {
    size_t count = mWidth * mHeight;
    uint32_t* buffer = new uint32_t[count];
    glReadPixels(0, 0, mWidth, mHeight, GL_RGBA, GL_UNSIGNED_BYTE, &amp;buffer[0]);

    size_t total = 0;
    for (size_t i = 0; i &lt; count; i++) {
        total += buffer[i] &amp; 0xff;
    }

    mOverdraw = total / float(count);

    delete[] buffer;
}</pre>

<p>还有QA可能用得到的一个指标：OverDraw数值，这个的源码位置在Framework/base/core/java/android/view/HardwareRender.java中</p>
<pre class="\"lang:java" decode:true\"="" title="\"DrawOverDrawCount\"">private void debugOverdraw(View.AttachInfo attachInfo, Rect dirty,
                HardwareCanvas canvas, DisplayList displayList) {

            if (mDebugOverdraw == OVERDRAW_TYPE_COUNT) {
                if (mDebugOverdrawLayer == null) {
                    mDebugOverdrawLayer = createHardwareLayer(mWidth, mHeight, true);
                } else if (mDebugOverdrawLayer.getWidth() != mWidth ||
                        mDebugOverdrawLayer.getHeight() != mHeight) {
                    mDebugOverdrawLayer.resize(mWidth, mHeight);
                }

                if (!mDebugOverdrawLayer.isValid()) {
                    mDebugOverdraw = -1;
                    return;
                }

                HardwareCanvas layerCanvas = mDebugOverdrawLayer.start(canvas, dirty);
                countOverdraw(layerCanvas);
                final int restoreCount = layerCanvas.save();
                layerCanvas.drawDisplayList(displayList, null, DisplayList.FLAG_CLIP_CHILDREN);
                layerCanvas.restoreToCount(restoreCount);
                mDebugOverdrawLayer.end(canvas);

                float overdraw = getOverdraw(layerCanvas);
                DisplayMetrics metrics = attachInfo.mRootView.getResources().getDisplayMetrics();

                drawOverdrawCounter(canvas, overdraw, metrics.density);
            }
}

private void drawOverdrawCounter(HardwareCanvas canvas, float overdraw, float density) {
            final String text = String.format(\"%.2fx\", overdraw);
            final Paint paint = setupPaint(density);
            // HSBtoColor will clamp the values in the 0..1 range
            paint.setColor(Color.HSBtoColor(0.28f - 0.28f * overdraw / 3.5f, 0.8f, 1.0f));

            canvas.drawText(text, density * 4.0f, mHeight - paint.getFontMetrics().bottom, paint);
}</pre>

<p>欢迎大家一起交流。</p>
<p>下一篇文章会用一个实际案例来讲解如何优化过渡绘制。</p>
<p>&nbsp;</p>
<p>参考文章：</p>
<p>1.<a href="\"> http://blog.chengyunfeng.com/?p=458# 翻译的一个老外的优化过程</a><br>(原链接<a href="http://www.curious-creature.org/2012/12/01/android-performance-case-study/" target="_blank" rel="external">http://www.curious-creature.org/2012/12/01/android-performance-case-study/</a>)<br>2. <a href="\">http://blog.csdn.net/yihongyuelan/article/details/12169647 </a>反编译并添加gpu显示</p>
<p>3. <a href="\">http://developer.android.com/training/improving-layouts/optimizing-layout.html#Inspect</a> 官网资料</p>
<p>4. <a href="\">http://developer.android.com/training/improving-layouts/reusing-layouts.html </a>官网资料</p>
<p>5. <a href="\">http://developer.android.com/training/improving-layouts/loading-ondemand.html</a> 官网资料</p>
<p>6. <a href="\">http://developer.android.com/training/improving-layouts/smooth-scrolling.html </a>官网资料</p>
<p>7.<a href="\"> http://developer.android.com/tools/help/hierarchy-viewer.html</a> 官网关于hierarchy view的介绍</p>
<p>8. <a href="\">http://tools.android.com/tips/lint lint</a>工具介绍</p>
<blockquote>
<p><span style="\"color:" #ff0000;\"="">作者：<a href="\" title="\">Gracker</a></span><br><span style="\"color:" #ff0000;\"="">出处：<a href="\" title="\">androidperformance.com</a></span><br><span style="\"color:" #ff0000;\"="">本文版权归作者所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。</span><br><span style="\"color:" #ff0000;\"="">打赏一下： <a href="\">微博打赏</a></span></p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-iphone6-and-apple-watch" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/09/10/iphone6-and-apple-watch/" class="article-date">
  	<time datetime="2014-09-09T23:49:34.000Z" itemprop="datePublished">2014-09-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/09/10/iphone6-and-apple-watch/">iphone6发布会简记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>手机：</p>
<ol>
<li>1.两款iphone：iphone6和iphone6 plus</li>
<li>iPhone 6分辨率：4.7寸1334 x 750，5.5寸1920 x 1080</li>
<li>苹果A8，64位处理器，比A7小13%，CPU快25%，图像处理快50%…苹果同时称这颗新的芯片可以让苹果保持持续的运算能力而不发出过多的热量。图中同时显示对手的芯片性能会随着运行时间下降。</li>
<li>摄像头依旧是 800 万像素，但配备了新的 iSight 传感器，对焦速度将是上一代的两倍，人脸识别速度也更快。</li>
<li>阳极氧化铝后盖，加不锈钢LOGO，新屏幕Renina HD屏幕。分辨率→iPhone 6：1334 x 750； iPhone 6 Plus：1920 x 1080；6.8 &amp; 7.1 毫米厚（5S 7.6毫米）</li>
<li>iPhone 6是数字化防抖 iPhone plus是光学防抖<br><a href="\"><img src="\" alt="\"></a></li>
<li>支持1080p的高清视频拍摄</li>
<li>更快 WIFI 模块以实现 3倍 WiFi 速度提升，并衍生出了 WIFI 通话功能。</li>
<li>续航能力比5S强，IP6支持11小时视频观看、上网，IP6 Plus支持14小时高清视频观看，IP6看高清视频可以支持一整天</li>
<li>新的运动处理器M8，可以更精确的记录你的运动状态，还带气压计，根据空气压力测量海拔高度</li>
<li>价格：<br><a href="\"><img src="\" alt="\"></a></li>
<li>19 号的首发地区共有 9 个，香港包含在内。大陆地区估计还要再等等。<br><a href="\"><img src="\" alt="\"></a></li>
<li>移动支付：主要利用了新 iPhone 配备的 NFC 模块、指纹识别和 Passbook 来实现。Apple Pay 将于 2014 年 10 月上线，适用于 iPhone 6 和 6 Plus<br><a href="\"><img src="\" alt="\"></a><a href="\"><img src="\" alt="\"></a><a href="\"><img src="\" alt="\"></a></li>
<li>iOS 8 则会在 9 月 17 日开始推送，支持设备请看图片<br><a href="\"><img src="\" alt="\"></a></li>
</ol>
<p>手表APPLE WATCH</p>
<ol>
<li>各种表带<br><a href="\"><img src="\" alt="\"></a></li>
<li>蓝宝石</li>
<li>手表侧面的圆环，应该是可以扭动的，可以放大或缩小屏幕显示内内容，或者进行功能列表选择</li>
<li>可以实现不少的功能，如接打电话，Siri 语音，回复短信，无线充电等，表盘采用了蓝宝石玻璃，不仅支持触摸，还加入了压力感应。</li>
<li>有些款的表带很不错，会自动吸附</li>
<li>Apple Watch 会有两种尺寸，三防 有18K金和玫瑰金版本</li>
<li>感应充电 把这个玩意贴在背面即可开始充电<br><a href="\"><img src="\" alt="\"></a></li>
<li>密集恐惧症患者勿入<br><a href="\"><img src="\" alt="\"></a></li>
<li>Apple Watch 也将具备基础的健康与健身功能</li>
<li>WatchKit，供第三方开发者开发适配应用</li>
<li>可以和手机进行互动<br><a href="\"><img src="\" alt="\"></a></li>
<li>支持的设备：<br><a href="\"><img src="\" alt="\"></a></li>
<li>价格：2015年开卖<br><a href="\"><img src="\" alt="\"></a></li>
<li>Apple Watch 将会有三个系列，同样也支持 Apple Pay 移动支付</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/科技与人文/">科技与人文</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-how-to-write-a-better-ppt" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/07/28/how-to-write-a-better-ppt/" class="article-date">
  	<time datetime="2014-07-28T10:46:44.000Z" itemprop="datePublished">2014-07-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/28/how-to-write-a-better-ppt/">极简PPT的九大原则</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <div>1、能十几页就不几十页；</div>

<div>2、能用图就不用字；</div>

<div>3、能用字就不用词；</div>

<div>4、能用词就不用句；</div>

<div>5、能用句就不用篇；</div>

<div>6、能讲故事就不讲理 论；</div>

<div>7、能谈问题就不谈概念；</div>

<div>8、逻辑、逻辑、逻辑；</div>

<div>9、你不可能面面俱到，让人记住哪怕只有一件事、一句话、一个词，就是成功。</div>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/科技与人文/">科技与人文</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-android-edittext-do-not-auto-get-focus" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/06/03/android-edittext-do-not-auto-get-focus/" class="article-date">
  	<time datetime="2014-06-02T16:31:49.000Z" itemprop="datePublished">2014-06-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/03/android-edittext-do-not-auto-get-focus/">[Android小技巧]:如何让EditText不自动获取焦点</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Android中,使用EditText作为输入框很方便,但是有时候EditText会自动获取焦点,其行为:点击进入这个页面后,EditText自动获取焦点,导致软键盘直接跳出.有时候这么做很方便,但是大部分时候我们还是希望在点击EditText的时候,软键盘才弹出来.</p>
<p>这里有个很简单也很实用的技巧,即在EditText的父Layout中,加入下面的两个属性即可:</p>
<p><pre class="lang:java decode:true ">android:focusable=”true”<br>android:focusableInTouchMode=”true”</pre><br>这样做的原理是让用户进入到这个页面之后,EditText的父控件 获取焦点,这样的话EditText就获取不到焦点,软键盘也不会自动弹起.只有在点击EditText的时候,软键盘才会弹起.</p>
<p>&nbsp;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-android-frame-animation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/06/01/android-frame-animation/" class="article-date">
  	<time datetime="2014-06-01T10:07:18.000Z" itemprop="datePublished">2014-06-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/01/android-frame-animation/">Android Frame animation模拟脉搏跳动小动画</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>逐帧动画是一种常见的动画形式（Frame By Frame），其原理是在“连续的关键帧”中分解动画动作，也就是在时间轴的每帧上逐帧绘制不同的内容，使其连续播放而成动画。 因为逐帧动画的帧序列内容不一样，不但给制作增加了负担而且最终输出的文件量也很大，但它的优势也很明显：逐帧动画具有非常大的灵活性，几乎可以表现任何想表现的内容，而它类似与电影的播放模式，很适合于表演细腻的动画。例如：人物或动物急剧转身、 头发及衣服的飘动、走路、说话以及精致的3D效果等等。</p>
<p>Android中的逐帧动画是Frame animation。<span style="\"color:" #000000;\"="">Frame animation可以被定义在XML文件中，也可以完全编码实现。3.0以前，android支持两种动画模式，tween animation,frame animation，在android3.0中又引入了一个新的动画系统：property animation，这三种动画模式在SDK中被称为property animation,view animation,drawable animation。 </span></p>
<p>本篇使用的方法是在xml中定义效果，以下是想达到的动画的效果。</p>
<p><a href="\"><img src="\" alt="\"></a></p>
<p>1.首先准备所需图片（逐帧）。</p>
<p><a href="\"><img src="\" alt="\"></a></p>
<p>2.在res/anim下或res/rawable下新建xml来编写动画效果。内容类似下图：</p>
<pre class="\"lang:java" decode:true\"="">&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\"
    android:oneshot=\"false\"&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00040\" android:duration=\"100\" /&gt;//duration是每帧图片的时长，单位ms
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00041\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00042\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00043\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00044\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00045\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00046\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00047\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00048\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00049\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00050\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00051\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00052\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00053\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00054\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00055\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00056\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00057\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00058\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00059\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00060\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00061\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00062\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00063\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00064\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00065\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00066\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00067\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00068\" android:duration=\"100\" /&gt;
    &lt;item android:drawable=\"@drawable/soundwave_new_1_00069\" android:duration=\"100\" /&gt;
&lt;/animation-list&gt;</pre>

<p>xml保存为scanning_anim.xml.其中,</p>
<pre class="\"lang:java" decode:true\"="">animation-list//最外层是animition-list控件，可以容纳item，每个item是一帧图片。</pre>

<pre class="\"lang:java" decode:true\"="">android:oneshot=\"false\"<span style="\"color:" #000000;\"="">//如果为true，表示动画只播放一次停止在最后一帧上，如果设置为false表示动画循环播放。</span></pre>

<p>3.以上xml中定义的动画要以一个imageView作为载体来显示。以下例子用一个类稍稍封装：</p>
<pre class="\"lang:java" decode:true\"="">public class ScanningAnimationView extends ImageView {
    AnimationDrawable scanningDrawable;
    public ScanningAnimationView(Context context) {
        super(context);
    }
    public ScanningAnimationView(Context context, AttributeSet attrs) {
        super(context, attrs);
        setBackgroundResource(R.anim.scanning_anim);
        scanningDrawable=(AnimationDrawable)this.getBackground();
    }

    public void start() {
        scanningDrawable.start();
    }
    public void stop() {
        scanningDrawable.stop();
    }
}</pre>

<p>4.用户直接使用这个封装好的ImageView调用start和stop即可。</p>
<p>调用动画：</p>
<pre class="\"lang:java" decode:true\"="">public class MainActivity extends ActionBarActivity {
    ScanningAnimationView image;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        image = (ScanningAnimationView)findViewById(R.id.imageView);
        Button startButton = (Button) findViewById(R.id.start);
        Button endButton = (Button)findViewById(R.id.end);
        startButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                image.start();
            }
        });

        endButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                image.stop();
            }
        });
    }
</pre>

<p>imageView的布局：</p>
<pre class="\"lang:java" decode:true\"="">&lt;com.example.nurse.app.util.ScanningAnimationView
    android:layout_width=\"wrap_content\"
    android:layout_height=\"wrap_content\"
    android:id=\"@+id/imageView\"
    android:layout_centerHorizontal=\"true\"
    android:layout_alignParentTop=\"true\"
    android:layout_alignParentStart=\"true\"/&gt;</pre>

<p>本篇完。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-using-listview-in-android" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/05/31/using-listview-in-android/" class="article-date">
  	<time datetime="2014-05-31T10:48:58.000Z" itemprop="datePublished">2014-05-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/31/using-listview-in-android/">[转]Using lists in Android (ListView)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="\"titlepage\"" style="\"color:" #000000;\"=""><br><div><br><div><br><br>### 前言<br><br>(<span style="\"color:" #ff0000;\"="">强烈建议每个做Android都仔细认真地看一下)</span>如何写好一篇技术文章!对于一个搞技术的来说,写好一篇技术博客,其实是蛮难的.有时候写不下去的时候,我就会看看这篇文章,看看别人是如何写好技术文章的(这篇文章在我的印象笔记中存了很久,每次用到ListView,我都会会翻出来看看.<br><br>然则这么好的文章,我实在是不敢自己一个人私藏,所以在这里贴出来给大家分享一下.翻译就免了,很大的工程,不过这里面的英文都比较简单,如果这个都看不懂,那就别看了.但是我建议每一个搞Android的都把这篇文章仔细地看一遍,因为我见到过许多不是很规范的ListView的写法,Item都没有重用,Adapter写得很乱.之类的…<br><br>原文地址:<a href="\">http://www.vogella.com/tutorials/AndroidListView/article.html</a><br><br>### 正文<br><br></div><br><div><br><br>Copyright © 2010, 2011, 2012, 2013, 2014 Lars Vogel<br><br></div><br><div><br><br>07.01.2014<br><br></div><br><div><br><div class="\"revhistory\""><br><table summary="\"Revision" history\"=""><br><tbody><br><tr><br><th colspan="\"4\"" align="\"left\"" valign="\"top\""><strong>Revision History</strong></th><br></tr><br><tr><br><td align="\"left\"">Revision 0.1 - 4.5</td><br><td align="\"left\"">01.07.2010 - 07.01.2014</td><br><td align="\"left\""><span class="\"firstname\"">Lars<br></span><span class="\"surname\"">Vogel<br></span></td><br><td align="\"left\"">bug fixes and enhancements</td><br></tr><br></tbody><br></table><br></div><br></div><br><div><br><div class="\"abstract\""><a style="\"font-weight:" bold;="" color:="" #101010;\"="" name="\"abstract\""></a><br><br><strong>Using Android ListView, ListActivity and ListFragment</strong><br><br>This tutorial describes how to use the ListView view together with Activities and Fragments in Android. The tutorial is based on Eclipse 4.3, Java 1.6 and Android 4.4.<br><br></div><br></div><br></div><br><div></div>

<hr>
<p></p></div><p></p>
<div class="\"toc\"" style="\"color:" #000000;\"=""><br><br><strong>Table of Contents</strong><br><br><dl><dt><span class="\"section\""><a href="\">1. Android and Lists</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">1.1. Using lists in Android</a></span></dt><dt><span class="\"section\""><a href="\">1.2. Views for handling lists</a></span></dt><dt><span class="\"section\""><a href="\">1.3. Possible input types for lists</a></span></dt><dt><span class="\"section\""><a href="\">1.4. Adapters</a></span></dt><dt><span class="\"section\""><a href="\">1.5. Filtering and sorting</a></span></dt><dt><span class="\"section\""><a href="\">1.6. Data updates in the adapter</a></span></dt><dt><span class="\"section\""><a href="\">1.7. Listener</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">2. Default adapter</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">2.1. Default platform adapter</a></span></dt><dt><span class="\"section\""><a href="\">2.2. Using ArrayAdapter</a></span></dt><dt><span class="\"section\""><a href="\">2.3. ListView example with ArrayAdapter</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">3. Custom adapter implementations</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">3.1. Developing a custom adapter</a></span></dt><dt><span class="\"section\""><a href="\">3.2. Preparing a row for the list</a></span></dt><dt><span class="\"section\""><a href="\">3.3. Example for a custom adapter</a></span></dt><dt><span class="\"section\""><a href="\">3.4. Updating the data model from the adapter</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">4. ListActivity and ListFragment</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">4.1. Default container for using ListView</a></span></dt><dt><span class="\"section\""><a href="\">4.2. ListActivity and custom layout</a></span></dt><dt><span class="\"section\""><a href="\">4.3. Placeholder for an empty list</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">5. Exercise: Using ListView and ListActivity</a></span></dt><dt><span class="\"section\""><a href="\">6. Exercise: ListActivity with own layout</a></span></dt><dt><span class="\"section\""><a href="\">7. Tutorial: Implementing your own adapter</a></span></dt><dt><span class="\"section\""><a href="\">8. ListViews and performance</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">8.1. Motivation</a></span></dt><dt><span class="\"section\""><a href="\">8.2. Time consuming operations</a></span></dt><dt><span class="\"section\""><a href="\">8.3. Avoiding layout inflation and object creation</a></span></dt><dt><span class="\"section\""><a href="\">8.4. Holder Pattern</a></span></dt><dt><span class="\"section\""><a href="\">8.5. Example</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">9. Storing the selection of a view</a></span></dt><dt><span class="\"section\""><a href="\">10. Contextual action mode for ListViews</a></span></dt><dt><span class="\"section\""><a href="\">11. Implementing undo for an action</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">11.1. When should you offer an undo action?</a></span></dt><dt><span class="\"section\""><a href="\">11.2. Example</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">12. Performance Optimization</a></span></dt><dt><span class="\"section\""><a href="\">13. Tutorial: How to display two items in a ListView</a></span></dt><dt><span class="\"section\""><a href="\">14. Selecting multiple items in the ListView</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">14.1. Interaction between the model and Listview</a></span></dt><dt><span class="\"section\""><a href="\">14.2. Tutorial: Domain Model and Rows interaction</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">15. Implementing an expandable ListView</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">15.1. ExpandableListView</a></span></dt><dt><span class="\"section\""><a href="\">15.2. ExpandableListView example</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">16. Tutorial: Miscellaneous</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">16.1. Adding a longclick listener to the list items</a></span></dt><dt><span class="\"section\""><a href="\">16.2. Header and Footer</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">17. SimpleCursorAdapter</a></span></dt><dt><span class="\"section\""><a href="\">18. Additional Open Source libraries</a></span></dt><dt><span class="\"section\""><a href="\">19. Support free vogella tutorials</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">19.1. Thank you</a></span></dt><dt><span class="\"section\""><a href="\">19.2. Questions and Discussion</a></span></dt></dl></dd><dt><span class="\"section\""><a href="\">20. Links and Literature</a></span></dt><dd><dl><dt><span class="\"section\""><a href="\">20.1. Source Code</a></span></dt><dt><span class="\"section\""><a href="\">20.2. ListView Resources</a></span></dt><dt><span class="\"section\""><a href="\">20.3. vogella Resources</a></span></dt></dl></dd></dl></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"androidlists\""></a>1. Android and Lists<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"androidlists_overview\""></a>1.1. Using lists in Android<br><br></div><br>The display of elements in a list is a very common pattern in mobile applications. The user sees a list of items and can scroll through them. Such an activity is depicted in the following picture.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br>Typically the user interacts with the list via the action bar, for example, via a refresh button. Individual list items can be selected. This selection can update the action bar or can trigger a detailed screen for the selection. The following graphic sketches that. On the selection of a list item another activity is started.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"androidlists_view\""></a>1.2. Views for handling lists<br><br></div><br>Android provides the <code>ListView</code> and the <code>ExpandableListView</code> classes which is capable of displaying a scrollable list of items.<br><br>The <code>ExpandableListView</code> class supports a grouping of items.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"androidlists_inputtype\""></a>1.3. Possible input types for lists<br><br></div><br>The input to the list (items in the list) can be arbitrary Java objects. The adapter extracts the correct data from the data object and assigns this data to the <em>views</em> in the row of the <code>ListView</code>.<br><br>These items are typically called the <em>data model</em> of the list. An adapter can receive data as input.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"androidlists_adapterintro\""></a>1.4. Adapters<br><br></div><br>An <em>adapter</em> manages the data model and adapts it to the individual rows in the list view. An adapter extends the<code>BaseAdapter</code> class.<br><br>Every line in the list view consists of a layout which can be as complex as you want. A typical line in a list view has an image on the left side and two text lines in the middle as depicted in the following graphic.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br>A layout file for a such a line might look like the following.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;RelativeLayout xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    android:layout_width=\”fill_parent\”<br>    android:layout_height=\”?android:attr/listPreferredItemHeight\”<br>    android:padding=\”6dip\” &gt;<br><br>    &lt;ImageView<br>        android:id=\”@+id/icon\”<br>        android:layout_width=\”wrap_content\”<br>        android:layout_height=\”fill_parent\”<br>        android:layout_alignParentBottom=\”true\”<br>        android:layout_alignParentTop=\”true\”<br>        android:layout_marginRight=\”6dip\”<br>        android:contentDescription=\”TODO\”<br>        android:src=\”@drawable/ic_launcher\” /&gt;<br><br>    &lt;TextView<br>        android:id=\”@+id/secondLine\”<br>        android:layout_width=\”fill_parent\”<br>        android:layout_height=\”26dip\”<br>        android:layout_alignParentBottom=\”true\”<br>        android:layout_alignParentRight=\”true\”<br>        android:layout_toRightOf=\”@id/icon\”<br>        android:ellipsize=\”marquee\”<br>        android:singleLine=\”true\”<br>        android:text=\”Description\”<br>        android:textSize=\”12sp\” /&gt;<br><br>    &lt;TextView<br>        android:layout_width=\”fill_parent\”<br>        android:layout_height=\”wrap_content\”<br>        android:layout_above=\”@id/secondLine\”<br>        android:layout_alignParentRight=\”true\”<br>        android:layout_alignParentTop=\”true\”<br>        android:layout_alignWithParentIfMissing=\”true\”<br>        android:layout_toRightOf=\”@id/icon\”<br>        android:gravity=\”center_vertical\”<br>        android:text=\”Example application\”<br>        android:textSize=\”16sp\” /&gt;<br><br>&lt;/RelativeLayout&gt;</pre><br>&nbsp;<br><br>The adapter would inflate the layout for each row in its <code>getView()</code> method and assign the data to the individual views in the row.<br><br>The adapter is assigned to the <code>ListView</code> via the <code>setAdapter</code> method on the <code>ListView</code> object.<br><div class="\"tip\""><br><br>### Tip<br><br>Adapters are not only used by <code>ListView</code>, but also by other views which extend<code>AdapterView</code> as, for example, <code>Spinner</code>, <code>GridView</code>, <code>Gallery</code> and <code>StackView</code>.<br><br></div><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"androidlists_filtersort\""></a>1.5. Filtering and sorting<br><br></div><br>Filtering and sorting of the data is handled by the adapter. You need to implement the logic in your custom adapter implementation.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterown_updates\""></a>1.6. Data updates in the adapter<br><br></div><br>The <code>notifyDataSetChanged()</code> method on the adapter is called if the data has changed or if new data is available.<br><br>The <code>notifyDataSetInvalidated()</code> method is called if the data is not available anymore.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listview_adapterlistener\""></a>1.7. Listener<br><br></div><br>To react to selections in the list, set an <code>OnItemClickListener</code> to your <code>ListView</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">listView.setOnItemClickListener(new OnItemClickListener() {<br>  @Override<br>  public void onItemClick(AdapterView&lt;?&gt; parent, View view,<br>    int position, long id) {<br>    Toast.makeText(getApplicationContext(),<br>      \”Click ListItem Number \” + position, Toast.LENGTH_LONG)<br>      .show();<br>  }<br>});</pre><br>&nbsp;<br><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listview_defaultadapter\""></a>2. Default adapter<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listview_defaultadapter\""></a>2.1. Default platform adapter<br><br></div><br>Android provides default adapter implementations; the most important are <code>ArrayAdapter</code> and <code>CursorAdapter</code>.<br><br><code>ArrayAdapter</code> can handle data based on <code>Arrays</code> or <code>java.util.List</code>.<br><br><code>SimpleCursorAdapter</code> can handle database related data.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"arrayAdapter\""></a>2.2. Using ArrayAdapter<br><br></div><br>The <code>ArrayAdapter</code> class can handle a list or array of Java objects as input. Every Java object is mapped to one row. By default, it maps the <code>toString()</code> method of the object to a view in the row layout.<br><br>You can define the ID of the view in the constructor of the <code>ArrayAdapter</code> otherwise the <code>android.R.id.text1</code> ID is used as default.<br><br>The <code>ArrayAdapter</code> class allows to remove all elements in its underlying data structure with the <code>clear()</code> method call. You can then add new elements via the <code>add()</code> method or a <code>Collection</code> via the <code>addAll()</code> method.<br><br>You can also directly modify the underlying data structure and call the <code>notifyDataSetChanged()</code> method on the adapter to notify it about the changes in data.<br><div class="\"warning\""><br><br>### Warning<br><br>If you want to change the data in your adapter, the underlying data structure must support this operation. This is, for example, the case for the <code>ArrayList</code> class, but not for arrays.<br><br></div><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listview_listviewexample\""></a>2.3. ListView example with ArrayAdapter<br><br></div><br>The following listing shows a layout file called <code>activity_listviewexampleactivity.xml</code> which includes a<code>ListView</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;ListView xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    android:id=\”@+id/listview\”<br>    android:layout_width=\”wrap_content\”<br>    android:layout_height=\”wrap_content\” /&gt;<br></pre><br>&nbsp;<br><br>The following example shows the usage of the <code>ListView</code> view in an activity. It uses a default layout from the Android platform for the row layout. It also demonstrates the removal of list items and uses animations for the removal.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package com.vogella.android.listview.withanimation;<br><br>public class ListViewExampleActivity extends Activity {<br><br>  @Override<br>  protected void onCreate(Bundle savedInstanceState) {<br>    super.onCreate(savedInstanceState);<br>    setContentView(R.layout.activity_listviewexampleactivity);<br><br>    final ListView listview = (ListView) findViewById(R.id.listview);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”, \”Linux\”,<br>        \”OS/2\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”, \”Linux\”, \”OS/2\”,<br>        \”Android\”, \”iPhone\”, \”WindowsMobile\” };<br><br>    final ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();<br>    for (int i = 0; i &lt; values.length; ++i) {<br>      list.add(values[i]);<br>    }<br>    final StableArrayAdapter adapter = new StableArrayAdapter(this,<br>        android.R.layout.simple_list_item_1, list);<br>    listview.setAdapter(adapter);<br><br>    listview.setOnItemClickListener(new AdapterView.OnItemClickListener() {<br><br>      @Override<br>      public void onItemClick(AdapterView&lt;?&gt; parent, final View view,<br>          int position, long id) {<br>        final String item = (String) parent.getItemAtPosition(position);<br>        view.animate().setDuration(2000).alpha(0)<br>            .withEndAction(new Runnable() {<br>              @Override<br>              public void run() {<br>                list.remove(item);<br>                adapter.notifyDataSetChanged();<br>                view.setAlpha(1);<br>              }<br>            });<br>      }<br><br>    });<br>  }<br><br>  private class StableArrayAdapter extends ArrayAdapter&lt;String&gt; {<br><br>    HashMap&lt;String, Integer&gt; mIdMap = new HashMap&lt;String, Integer&gt;();<br><br>    public StableArrayAdapter(Context context, int textViewResourceId,<br>        List&lt;String&gt; objects) {<br>      super(context, textViewResourceId, objects);<br>      for (int i = 0; i &lt; objects.size(); ++i) {<br>        mIdMap.put(objects.get(i), i);<br>      }<br>    }<br><br>    @Override<br>    public long getItemId(int position) {<br>      String item = getItem(position);<br>      return mIdMap.get(item);<br>    }<br><br>    @Override<br>    public boolean hasStableIds() {<br>      return true;<br>    }<br><br>  }<br><br>}</pre><br>&nbsp;<br><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"adapterown\""></a>3. Custom adapter implementations<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterown_custom\""></a>3.1. Developing a custom adapter<br><br></div><br>The <code>ArrayAdapter</code> is limited as it supports only the mapping of <code>toString()</code> to one view in the row layout. To control the data assignment and to support several views, you have to create your custom adapter implementation.<br><br>For this you would extend an existing adapter implementation or subclass the <code>BaseAdapter</code> class directly.<br><div class="\"tip\""><br><br>### Tip<br><br>Frequently you extend <code>ArrayAdapter</code> to write a custom adapter, as this is simpler than extending <code>BaseAdapter</code> directly.<br><br></div><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterown_inflating\""></a>3.2. Preparing a row for the list<br><br></div><br>The adapter needs to create a layout for each row of the list. The <code>ListView</code> instance calls the <code>getView()</code> method on the adapter for each data element. In this method the adapter creates the row layout and maps the data to the views in the layout.<br><br>This root of the layout is typically a <code>ViewGroup</code> (layout manager) and contains several other views , e.g., an<code>ImageView</code> and a <code>TextView</code>. The following graphic shows a list with different layouts for odd and even rows.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br>Within the <code>getView()</code> method you would inflate an XML based layout and then set the content of the individual views based on the Java object for this row. To inflate the XML layout file, you can use the <code>LayoutInflator</code> system service.<br><div class="\"note\""><br><br>### Note<br><br>This layout inflator service can get accessed via the <code>getLayoutInflator()</code> method of the activity or via the <code>context.getSystemService(Context.LAYOUT_INFLATER_SERVICE)</code>method call.<br><br></div><br>After the adapter inflated the layout, it searches for the relevant views in the layout and fills them with the data. The individual elements in the layout can be found via the <code>findViewById()</code> method call on the top level view.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterown_example\""></a>3.3. Example for a custom adapter<br><br></div><br>The following code shows an implementation of a custom adapter. This adapter assumes that you have two png files (no.png and yes.png) in one of your <code>res/drawable</code> folders. The coding inflates an XML layout file, finds the relevant views in the layout and sets their content based on the input data.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.content.Context;<br>import android.view.LayoutInflater;<br>import android.view.View;<br>import android.view.ViewGroup;<br>import android.widget.ArrayAdapter;<br>import android.widget.ImageView;<br>import android.widget.TextView;<br><br>public class MySimpleArrayAdapter extends ArrayAdapter&lt;String&gt; {<br>  private final Context context;<br>  private final String[] values;<br><br>  public MySimpleArrayAdapter(Context context, String[] values) {<br>    super(context, R.layout.rowlayout, values);<br>    this.context = context;<br>    this.values = values;<br>  }<br><br>  @Override<br>  public View getView(int position, View convertView, ViewGroup parent) {<br>    LayoutInflater inflater = (LayoutInflater) context<br>        .getSystemService(Context.LAYOUT<em>INFLATER_SERVICE);<br>    View rowView = inflater.inflate(R.layout.rowlayout, parent, false);<br>    TextView textView = (TextView) rowView.findViewById(R.id.label);<br>    ImageView imageView = (ImageView) rowView.findViewById(R.id.icon);<br>    textView.setText(values[position]);<br>    // change the icon for Windows and iPhone<br>    String s = values[position];<br>    if (s.startsWith(\”iPhone\”)) {<br>      imageView.setImageResource(R.drawable.no);<br>    } else {<br>      imageView.setImageResource(R.drawable.ok);<br>    }<br><br>    return rowView;<br>  }<br>}</em></pre><br>&nbsp;<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterown_interaction\""></a>3.4. Updating the data model from the adapter<br><br></div><br>The row can also contain _views which interact with the underlying data model via the adapter. For example, you can have a <code>Checkbox</code> in your row layout and if the <code>Checkbox</code> is selected, the underlying data is changed.<br><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listactivity\""></a>4. ListActivity and ListFragment<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listactivity_overview\""></a>4.1. Default container for using ListView<br><br></div><br>Android provides specialized fragment and activity classes to simplify list handling.<br><br>The classes are the <code>ListActivity</code> class if you want to use lists in activities and the the <code>ListFragment</code> class if you want to use lists in fragments.<br><br>You do not have to assign a layout to these elements. If you do not define a layout, the activity or fragment contains a single <code>ListView</code> by default. <code>ListActivity</code> and <code>ListFragment</code> also allow you to override a <code>onListItemClick()</code>method for handling selection of list items.<br><br>Both classes allow you to set the adapter to the default <code>ListView</code> via the <code>setListAdapter()</code> method.<br><br>The following example code shows a simple <code>ListFragment</code> implementation.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.fragments;<br><br>import android.content.Intent;<br>import android.os.Bundle;<br>import android.view.View;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br>import android.app.ListFragment;<br><br>public class MyListFragment extends ListFragment {<br><br>  @Override<br>  public void onActivityCreated(Bundle savedInstanceState) {<br>    super.onActivityCreated(savedInstanceState);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\” };<br>    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(getActivity(),<br>        android.R.layout.simple_list_item_1, values);<br>    setListAdapter(adapter);<br>  }<br><br>  @Override<br>  public void onListItemClick(ListView l, View v, int position, long id) {<br>    // do something with the data<br>  }<br>}<br></pre><br>&nbsp;<br><br>The next example code demonstrates the usage of a <code>ListActivity</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.widget.ArrayAdapter;<br><br>public class MyListActivity extends ListActivity {<br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\” };<br>    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,<br>        android.R.layout.simple_list_item_1, values);<br>    setListAdapter(adapter);<br>  }<br>}</pre><br>&nbsp;<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listactivity_layout\""></a>4.2. ListActivity and custom layout<br><br></div><br>You can use a custom layout with <code>ListActivity</code> or <code>ListFragment</code>. In this case the fragment or activity searches in the provided layout for a <code>ListView</code> with the pre-defined <code>android:id</code> attribute set to <code>@android:id/list</code>. This usage is demonstrated by the following code snippet.<br><br>&nbsp;<br><pre class="\"programlisting\""><span class="\"hl-tag\"" style="\"color:" #008800;\"="">&lt;ListView</span><br>  <span class="\"hl-attribute\"" style="\"color:" #7f0055;\"="">android:id</span>=<span class="\"hl-value\"" style="\"color:" blue;\"="">\”@android:id/list\”</span><br>  <span class="\"hl-attribute\"" style="\"color:" #7f0055;\"="">android:layout_width</span>=<span class="\"hl-value\"" style="\"color:" blue;\"="">\”match_parent\”</span><br>  <span class="\"hl-attribute\"" style="\"color:" #7f0055;\"="">android:layout_height</span>=<span class="\"hl-value\"" style="\"color:" blue;\"="">\”wrap_content\”</span><span class="\"hl-tag\"" style="\"color:" #008800;\"=""> &gt;</span><br><span class="\"hl-tag\"" style="\"color:" #008800;\"="">&lt;/ListView&gt;</span></pre><br>&nbsp;<br><div class="\"warning\""><br><br>### Warning<br><br>If you do not use this ID or do not include a <code>ListView</code> into your layout, the application crashes once you try to display the activity or the fragment.<br><br></div><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listactivity_emptyview\""></a>4.3. Placeholder for an empty list<br><br></div><br>You can also use a view with the <code>@android:id/empty</code> ID in your layout. The corresponding activity and fragment shows this view automatically if the <code>ListView</code> is empty and hides it otherwise. For example, you could display an error message in such a view.<br><br></div><br></div>

<div style="\"color:" #000000;\"="" data-type="\"ad\"" data-publisher="\"lqm.javaeclipseandroid.site\"" data-zone="\"ron\"" data-format="\"728x90\""></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"exercise_listsactivity_simple\""></a>5. Exercise: Using ListView and ListActivity<br><br></div><br>The following exercise demonstrates how to use a <code>ListView</code> in an <code>ListActivity</code>. You use the predefined<code>ArrayAdapter</code> class and an existing Android layout for the rows.<br><br>Create a new Android project called <em>de.vogella.android.listactivity</em> with the activity called <code>MyListActivity</code>.<br><br>Change <code>MyListActivity</code> class based on the the following code example. Note that the <code>setContentView()</code> method is not used.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.view.View;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br>import android.widget.Toast;<br><br>public class MyListActivity extends ListActivity {<br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\” };<br>    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,<br>        android.R.layout.simple_list_item_1, values);<br>    setListAdapter(adapter);<br>  }<br><br>  @Override<br>  protected void onListItemClick(ListView l, View v, int position, long id) {<br>    String item = (String) getListAdapter().getItem(position);<br>    Toast.makeText(this, item + \” selected\”, Toast.LENGTH_LONG).show();<br>  }<br>}</pre><br>&nbsp;<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listsactivity_layout\""></a>6. Exercise: ListActivity with own layout<br><br></div><br>In our example your will define your layout for the rows and use it in your adapter.<br><br>Create the <code>rowlayout.xml</code> layout file in the <code>res/layout</code> folder of the <code>de.vogella.android.listactivity</code> project.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;?xml version=\”1.0\” encoding=\”utf-8\”?&gt;<br>&lt;LinearLayout xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    android:layout_width=\”wrap_content\”<br>    android:layout_height=\”wrap_content\” &gt;<br><br>    &lt;ImageView<br>        android:id=\”@+id/icon\”<br>        android:layout_width=\”22px\”<br>        android:layout_height=\”22px\”<br>        android:layout_marginLeft=\”4px\”<br>        android:layout_marginRight=\”10px\”<br>        android:layout_marginTop=\”4px\”<br>        android:src=\”@drawable/ic_launcher\” &gt;<br>    &lt;/ImageView&gt;<br><br>    &lt;TextView<br>        android:id=\”@+id/label\”<br>        android:layout_width=\”wrap_content\”<br>        android:layout_height=\”wrap_content\”<br>        android:text=\”@+id/label\”<br>        android:textSize=\”20px\” &gt;<br>    &lt;/TextView&gt;<br><br>&lt;/LinearLayout&gt;</pre><br>&nbsp;<br><br>Change your activity so that is using the new layout.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.view.View;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br>import android.widget.Toast;<br><br>public class MyListActivity extends ListActivity {<br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\” };<br>    // use your custom layout<br>    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,<br>        R.layout.rowlayout, R.id.label, values);<br>    setListAdapter(adapter);<br>  }<br><br>  @Override<br>  protected void onListItemClick(ListView l, View v, int position, long id) {<br>    String item = (String) getListAdapter().getItem(position);<br>    Toast.makeText(this, item + \” selected\”, Toast.LENGTH_LONG).show();<br>  }<br>}<br></pre><br>&nbsp;<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"tutorial_ownadapter\""></a>7. Tutorial: Implementing your own adapter<br><br></div><br>The following uses two images \”no.png\” and \”ok.png\”. I placed it in the \”res/drawable-mdpi\” folder. You must create your own icons. In case you do not find any icons just copy \”icon.png\” and use a drawing program to change it a little bit.<br><br>Create the class <code>MySimpleArrayAdapter</code> which will serve as our adapter.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.content.Context;<br>import android.view.LayoutInflater;<br>import android.view.View;<br>import android.view.ViewGroup;<br>import android.widget.ArrayAdapter;<br>import android.widget.ImageView;<br>import android.widget.TextView;<br><br>public class MySimpleArrayAdapter extends ArrayAdapter&lt;String&gt; {<br>  private final Context context;<br>  private final String[] values;<br><br>  public MySimpleArrayAdapter(Context context, String[] values) {<br>    super(context, R.layout.rowlayout, values);<br>    this.context = context;<br>    this.values = values;<br>  }<br><br>  @Override<br>  public View getView(int position, View convertView, ViewGroup parent) {<br>    LayoutInflater inflater = (LayoutInflater) context<br>        .getSystemService(Context.LAYOUT<em>INFLATER_SERVICE);<br>    View rowView = inflater.inflate(R.layout.rowlayout, parent, false);<br>    TextView textView = (TextView) rowView.findViewById(R.id.label);<br>    ImageView imageView = (ImageView) rowView.findViewById(R.id.icon);<br>    textView.setText(values[position]);<br>    // Change the icon for Windows and iPhone<br>    String s = values[position];<br>    if (s.startsWith(\”Windows7\”) || s.startsWith(\”iPhone\”)<br>        || s.startsWith(\”Solaris\”)) {<br>      imageView.setImageResource(R.drawable.no);<br>    } else {<br>      imageView.setImageResource(R.drawable.ok);<br>    }<br><br>    return rowView;<br>  }<br>}<br></em></pre><br>&nbsp;<br><br>To use this adapter, change the _activity to the following.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br><br>public class MyListActivity extends ListActivity {<br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\” };<br>    MySimpleArrayAdapter adapter = new MySimpleArrayAdapter(this, values);<br>    setListAdapter(adapter);<br>  }<br>}</pre><br>&nbsp;<br><br>If you run this example you should get a list with different icons for the certain elements.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"adapterperformance\""></a>8. ListViews and performance<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterperformance_motivation\""></a>8.1. Motivation<br><br></div><br>Performance is especially important on Android as users expect fast reaction times. Compared to desktop computers an Android device is relatively slow from the hardware perspective.<br><br>This part describes how to reduce these operations to implement your custom list adapter efficiently. The default Android adapters like <code>ArrayAdapter</code> are already performance optimized.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterperformance_problems\""></a>8.2. Time consuming operations<br><br></div><br>Every view which get inflated from an XML layout file will result in a Java object. Inflating layouts and creating Java objects is expensive with regards to time and memory consumption.<br><br>In addition using the <code>findViewById()</code> method is relatively time consuming, even though it is not as bad as XML inflating.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterperformance_convertview\""></a>8.3. Avoiding layout inflation and object creation<br><br></div><br>A <code>ListView</code> typically contains more data than the number of displayed rows. If the user scrolls the list, then rows and their associated views are being scrolled out of the visible area. The Java objects which represents the rows can be reused for newly visible rows.<br><br>If Android determines that a row is not visible anymore, it allows the <code>getView()</code> of the adapter method to reuse the associated view via the <code>convertView</code> parameter.<br><br>The adapter can assign new data to the views contained in the view hierarchy of the <code>convertView</code>. This avoids inflating an XML file and creating new Java objects.<br><br>In case Android cannot reuse a row, the Android system passes <code>null</code> to the <code>convertView</code> parameter. Therefore the adapter implementation needs to check for this.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterperformance_holder\""></a>8.4. Holder Pattern<br><br></div><br>The <em>View Holder</em> pattern allows to avoid the <code>findViewById()</code> method in the adapter.<br><br>A <code>ViewHolder</code> class is a static inner class in your adapter which holds references to the relevant views. in your layout. This reference is assigned to the row view as a tag via the <code>setTag()</code> method.<br><br>If we receive a <code>convertView</code> object, we can get the instance of the <code>ViewHolder</code> via the <code>getTag()</code> method and assign the new attributes to the views via the <code>ViewHolder</code> reference.<br><br>While this sounds complex this is approximately 15 % faster then using the <code>findViewById()</code> method.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"adapterperformance_example\""></a>8.5. Example<br><br></div><br>The following code shows a performance optimized adapter implementation which reuses existing views and implements the holder pattern.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.Activity;<br>import android.view.LayoutInflater;<br>import android.view.View;<br>import android.view.ViewGroup;<br>import android.widget.ArrayAdapter;<br>import android.widget.ImageView;<br>import android.widget.TextView;<br><br>public class MyPerformanceArrayAdapter extends ArrayAdapter&lt;String&gt; {<br>  private final Activity context;<br>  private final String[] names;<br><br>  static class ViewHolder {<br>    public TextView text;<br>    public ImageView image;<br>  }<br><br>  public MyPerformanceArrayAdapter(Activity context, String[] names) {<br>    super(context, R.layout.rowlayout, names);<br>    this.context = context;<br>    this.names = names;<br>  }<br><br>  @Override<br>  public View getView(int position, View convertView, ViewGroup parent) {<br>    View rowView = convertView;<br>    // reuse views<br>    if (rowView == null) {<br>      LayoutInflater inflater = context.getLayoutInflater();<br>      rowView = inflater.inflate(R.layout.rowlayout, null);<br>      // configure view holder<br>      ViewHolder viewHolder = new ViewHolder();<br>      viewHolder.text = (TextView) rowView.findViewById(R.id.TextView01);<br>      viewHolder.image = (ImageView) rowView<br>          .findViewById(R.id.ImageView01);<br>      rowView.setTag(viewHolder);<br>    }<br><br>    // fill data<br>    ViewHolder holder = (ViewHolder) rowView.getTag();<br>    String s = names[position];<br>    holder.text.setText(s);<br>    if (s.startsWith(\”Windows7\”) || s.startsWith(\”iPhone\”)<br>        || s.startsWith(\”Solaris\”)) {<br>      holder.image.setImageResource(R.drawable.no);<br>    } else {<br>      holder.image.setImageResource(R.drawable.ok);<br>    }<br><br>    return rowView;<br>  }<br>}</pre><br>&nbsp;<br><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listview_selection\""></a>9. Storing the selection of a view<br><br></div><br>By default a <code>ListView</code> has no selection mode active. You can activate it via the <code>setChoiceMode()</code> method call. Pass<code>ListView.CHOICE_MODE_MULTIPLE</code> for multiple selections or <code>ListView.CHOICE_MODE_SINGLE</code> for single selections to this method.<br><br>To get the selected items of a <code>ListView</code>, use the <code>getCheckedItemPosition()</code> for a single selection method or<code>listView.getCheckedItemPositions()</code> for multiple selections. . If you have stable ID, you could also use the<code>getCheckedItemIds()</code> method to get the selected IDs.<br><br>Android already provides a default layout for this: the <code>android.R.layout.simple_list_item_multiple_choice</code> layout which contains a configured <code>CheckedTextView</code> view.<br><br>The following activities demonstrate how to use these selection modes. If you use these modes, the <code>ListView</code>stores the selected values. It is not persisted in your data model.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package com.vogella.android.listview.selection.multi;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.view.Menu;<br>import android.view.MenuItem;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br>import android.widget.Toast;<br><br>import com.vogella.android.listview.selection.R;<br><br>public class MainActivity extends ListActivity {<br><br>  @Override<br>  protected void onCreate(Bundle savedInstanceState) {<br>    super.onCreate(savedInstanceState);<br>    String[] values = new String[] { \”a\”, \”b\”, \”c\”, \”d\”, \”e\”, \”f\”, \”g\”,<br>        \”h\”, \”i\”, \”j\”, \”k\”, \”l\”, \”m\”, \”n\”, \”o\”, \”p\”, \”q\”, \”r\”, \”s\”,<br>        \”t\”, \”u\”, \”w\”, \”x\”, \”y\”, \”z\” };<br><br>    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,<br>        android.R.layout.simple_list_item_multiple_choice, values);<br>    setListAdapter(adapter);<br>    getListView().setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);<br>  }<br><br>  @Override<br>  public boolean onCreateOptionsMenu(Menu menu) {<br>    getMenuInflater().inflate(R.menu.main, menu);<br>    return true;<br>  }<br><br>  @Override<br>  public boolean onOptionsItemSelected(MenuItem item) {<br>    Toast.makeText(this,<br>        String.valueOf(getListView().getCheckedItemCount()),<br>        Toast.LENGTH_LONG).show();<br>    return true;<br>  }<br>}</pre><br>&nbsp;<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package com.vogella.android.listview.selection.single;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.view.Menu;<br>import android.view.MenuItem;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br>import android.widget.Toast;<br><br>public class MainActivity extends ListActivity {<br><br>  @Override<br>  protected void onCreate(Bundle savedInstanceState) {<br>    super.onCreate(savedInstanceState);<br>    String[] values = new String[] { \”a\”, \”b\”, \”c\”, \”d\”, \”e\”, \”f\”, \”g\”,<br>        \”h\”, \”i\”, \”j\”, \”k\”, \”l\”, \”m\”, \”n\”, \”o\”, \”p\”, \”q\”, \”r\”, \”s\”,<br>        \”t\”, \”u\”, \”w\”, \”x\”, \”y\”, \”z\” };<br><br>    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,<br>        android.R.layout.simple_list_item_single_choice, values);<br>    setListAdapter(adapter);<br>    getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);<br>  }<br><br>  @Override<br>  public boolean onCreateOptionsMenu(Menu menu) {<br>    getMenuInflater().inflate(R.menu.main, menu);<br>    return true;<br>  }<br><br>  @Override<br>  public boolean onOptionsItemSelected(MenuItem item) {<br>    Toast.makeText(this,<br>        String.valueOf(getListView().getCheckedItemCount()),<br>        Toast.LENGTH_LONG).show();<br>    return true;<br>  }<br>}</pre><br>&nbsp;<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listview_actionbar\""></a>10. Contextual action mode for ListViews<br><br></div><br>The following assumes that you already familiar with the concept of the <em>ActionBar</em> and contextual action mode in general. This part will explain how to use contextual action mode for a <code>ListView</code> selection.<br><br>To assign a contextual action mode to a long click on an individual item, use the method<code>setOnItemLongClickListener()</code> on <code>ListView</code>. This methods includes information about the selected item. In this method you can start the <code>ActionMode</code>.<br><br>The following examples demonstrate that. It assumes that you have a menu XML file defined called<code>rowselection.xml</code> and that this menu contains one entry with the <em><code>@+id/menuitem1_show</code></em> ID.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.view.ActionMode;<br>import android.view.Menu;<br>import android.view.MenuInflater;<br>import android.view.MenuItem;<br>import android.view.View;<br>import android.widget.AdapterView;<br>import android.widget.AdapterView.OnItemLongClickListener;<br>import android.widget.Toast;<br><br>public class MyListActivityActionbar extends ListActivity {<br><br>  protected Object mActionMode;<br>  public int selectedItem = -1;<br><br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    setContentView(R.layout.main);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”, \”Linux\”,<br>        \”OS/2\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”, \”Linux\”, \”OS/2\” };<br><br>    MySimpleArrayAdapter adapter = new MySimpleArrayAdapter(this, values);<br>    setListAdapter(adapter);<br><br>    getListView().setOnItemLongClickListener(new OnItemLongClickListener() {<br><br>      @Override<br>      public boolean onItemLongClick(AdapterView&lt;?&gt; parent, View view,<br>          int position, long id) {<br><br>        if (mActionMode != null) {<br>          return false;<br>        }<br>        selectedItem = position;<br><br>        // start the CAB using the ActionMode.Callback defined above<br>        mActionMode = MyListActivityActionbar.this<br>            .startActionMode(mActionModeCallback);<br>        view.setSelected(true);<br>        return true;<br>      }<br>    });<br>  }<br><br>  private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {<br><br>    // called when the action mode is created; startActionMode() was called<br>    public boolean onCreateActionMode(ActionMode mode, Menu menu) {<br>      // Inflate a menu resource providing context menu items<br>      MenuInflater inflater = mode.getMenuInflater();<br>      // assumes that you have \”contexual.xml\” menu resources<br>      inflater.inflate(R.menu.rowselection, menu);<br>      return true;<br>    }<br><br>    // the following method is called each time<br>    // the action mode is shown. Always called after<br>    // onCreateActionMode, but<br>    // may be called multiple times if the mode is invalidated.<br>    public boolean onPrepareActionMode(ActionMode mode, Menu menu) {<br>      return false; // Return false if nothing is done<br>    }<br><br>    // called when the user selects a contextual menu item<br>    public boolean onActionItemClicked(ActionMode mode, MenuItem item) {<br>      switch (item.getItemId()) {<br>      case R.id.menuitem1_show:<br>        show();<br>        // the Action was executed, close the CAB<br>        mode.finish();<br>        return true;<br>      default:<br>        return false;<br>      }<br>    }<br><br>    // called when the user exits the action mode<br>    public void onDestroyActionMode(ActionMode mode) {<br>      mActionMode = null;<br>      selectedItem = -1;<br>    }<br>  };<br><br>  private void show() {<br>    Toast.makeText(MyListActivityActionbar.this,<br>        String.valueOf(selectedItem), Toast.LENGTH_LONG).show();<br>  }<br>}</pre><br>&nbsp;<br><br>If you start your application and long press on an item in the list, you get your contextual action bar.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listview_undoaction\""></a>11. Implementing undo for an action<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listview_undoaction1\""></a>11.1. When should you offer an undo action?<br><br></div><br>It is good practice to allow the user to undo critical actions. Such a critical action is, for example, the deletion of list items.<br><br>A proven pattern to handle this undo option is to offer a selection at the end of the screen. This selection vanishes after a predefined time or once the user continues to interact with the application.<br><br>For example, the Gmail application implements such a behavior.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listview_undoaction2\""></a>11.2. Example<br><br></div><br>The following description contains an example for implementing an undo action. It uses an animation to phase out the undo button automatically out after a while.<br><br>For this example create a new project called <em>com.vogella.android.userinterface.undo</em> based on the <em>BlankTemplate_template.<br><br>Create the following layout for your _activity</em>. It uses a <code>FrameLayout</code> to show two different parts of the user interface. The button bar is initially hidden. The button uses a drawable. Either add such a drawable to your project or remove the reference.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;FrameLayout xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    xmlns:tools=\”<a href="http://schemas.android.com/tools\" target="_blank" rel="external">http://schemas.android.com/tools\</a>“<br>    android:layout<em>width=\”match_parent\”<br>    android:layout_height=\”match_parent\” &gt;<br><br>    &lt;RelativeLayout<br>        android:layout_width=\”match_parent\”<br>        android:layout_height=\”match_parent\”<br>        tools:context=\”.MainActivity\” &gt;<br><br>        &lt;ListView<br>            android:id=\”@+id/listview\”<br>            android:layout_width=\”match_parent\”<br>            android:layout_height=\”match_parent\” &gt;<br>        &lt;/ListView&gt;<br>    &lt;/RelativeLayout&gt;<br><br>    &lt;LinearLayout<br>        android:id=\”@+id/undobar\”<br>        android:visibility=\”gone\”<br>        android:layout_width=\”wrap_content\”<br>        android:layout_height=\”wrap_content\”<br>        android:layout_gravity=\”bottom|center_horizontal\”<br>        android:layout_margin=\”20dp\”<br>        android:alpha=\”100\”<br>        android:background=\”#808080\”<br>        android:dividerPadding=\”11dp\”<br>        android:padding=\”4dp\” &gt;<br><br>        &lt;TextView<br>            android:id=\”@+id/undobar_message\”<br>            android:layout_width=\”wrap_content\”<br>            android:layout_height=\”wrap_content\”<br>            android:text=\”Deleted\”<br>            android:textAppearance=\”?android:attr/textAppearanceMedium\”<br>            android:textColor=\”#fff\” /&gt;<br><br>        &lt;Button<br>            android:id=\”@+id/undobar_button\”<br>            android:layout_width=\”wrap_content\”<br>            android:layout_height=\”wrap_content\”<br>            android:layout_marginLeft=\”30dp\”<br>            android:onClick=\”onClick\”<br>            android:background=\”#808080\”<br>            android:drawableLeft=\”@drawable/ic_undobar_undo\”<br>            android:text=\”Undo\”<br>            android:textAppearance=\”?android:attr/textAppearanceMedium\”<br>            android:textColor=\”#fff\” /&gt;<br>    &lt;/LinearLayout&gt;<br><br>&lt;/FrameLayout&gt;</em></pre><br>&nbsp;<br><br>Change your _activity so that it is similar to the following code. The Android project wizard in Eclipse already generated an <code>ActionBar</code> entry. This entry is used in the following code. If in doubt, create your own <code>ActionBar</code> entry.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package com.vogella.android.userinterface.undo;<br><br>import android.app.Activity;<br>import android.os.Bundle;<br>import android.view.Menu;<br>import android.view.MenuItem;<br>import android.view.View;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br>import android.widget.Toast;<br><br>import com.vogella.android.actionbar.undo.R;<br><br>public class MainActivity extends Activity {<br><br>  private View viewContainer;<br><br>  @Override<br>  protected void onCreate(Bundle savedInstanceState) {<br>    super.onCreate(savedInstanceState);<br>    setContentView(R.layout.activity<em>main);<br>    ListView l = (ListView) findViewById(R.id.listview);<br>    String[] values = new String[] { \”Ubuntu\”, \”Android\”, \”iPhone\”,<br>        \”Windows\”, \”Ubuntu\”, \”Android\”, \”iPhone\”, \”Windows\” };<br>    ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,<br>        android.R.layout.simple_list_item_1, values);<br>    viewContainer = findViewById(R.id.undobar);<br>    l.setAdapter(adapter);<br>  }<br><br>  @Override<br>  public boolean onCreateOptionsMenu(Menu menu) {<br>    // Inflate the menu; this adds items to the action bar if it is present.<br>    getMenuInflater().inflate(R.menu.activity_main, menu);<br>    return true;<br>  }<br><br>  @Override<br>  public boolean onOptionsItemSelected(MenuItem item) {<br>    showUndo(viewContainer);<br>    return true;<br>  }<br><br>  public void onClick(View view) {<br>    Toast.makeText(this, \”Deletion undone\”, Toast.LENGTH_LONG).show();<br>    viewContainer.setVisibility(View.GONE);<br>  }<br><br>  public static void showUndo(final View viewContainer) {<br>    viewContainer.setVisibility(View.VISIBLE);<br>    viewContainer.setAlpha(1);<br>    viewContainer.animate().alpha(0.4f).setDuration(5000)<br>        .withEndAction(new Runnable() {<br><br>          @Override<br>          public void run() {<br>            viewContainer.setVisibility(View.GONE);<br>          }<br>        });<br><br>  }<br>}</em></pre><br>&nbsp;<br><br>If you select the entry in the _ActionBar, the button bar becomes visible for 5 seconds.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listsactivity_performance\""></a>12. Performance Optimization<br><br></div><br>The following will implement a performance optimized version of the adapter from the previous example.<br><br>Create the following <code>MyPerformanceArrayAdapter</code> class.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.Activity;<br>import android.view.LayoutInflater;<br>import android.view.View;<br>import android.view.ViewGroup;<br>import android.widget.ArrayAdapter;<br>import android.widget.ImageView;<br>import android.widget.TextView;<br><br>public class MyPerformanceArrayAdapter extends ArrayAdapter&lt;String&gt; {<br>  private final Activity context;<br>  private final String[] names;<br><br>  static class ViewHolder {<br>    public TextView text;<br>    public ImageView image;<br>  }<br><br>  public MyPerformanceArrayAdapter(Activity context, String[] names) {<br>    super(context, R.layout.rowlayout, names);<br>    this.context = context;<br>    this.names = names;<br>  }<br><br>  @Override<br>  public View getView(int position, View convertView, ViewGroup parent) {<br>    View rowView = convertView;<br>    // reuse views<br>    if (rowView == null) {<br>      LayoutInflater inflater = context.getLayoutInflater();<br>      rowView = inflater.inflate(R.layout.rowlayout, null);<br>      // configure view holder<br>      ViewHolder viewHolder = new ViewHolder();<br>      viewHolder.text = (TextView) rowView.findViewById(R.id.TextView01);<br>      viewHolder.image = (ImageView) rowView<br>          .findViewById(R.id.ImageView01);<br>      rowView.setTag(viewHolder);<br>    }<br><br>    // fill data<br>    ViewHolder holder = (ViewHolder) rowView.getTag();<br>    String s = names[position];<br>    holder.text.setText(s);<br>    if (s.startsWith(\”Windows7\”) || s.startsWith(\”iPhone\”)<br>        || s.startsWith(\”Solaris\”)) {<br>      holder.image.setImageResource(R.drawable.no);<br>    } else {<br>      holder.image.setImageResource(R.drawable.ok);<br>    }<br><br>    return rowView;<br>  }<br>}</pre><br>&nbsp;<br><br>Use your new adapter in your <em>activity</em>. If you run the application it should look the same but it will be much faster, especially for large datasets.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br><br>public class MyListActivity extends ListActivity {<br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    String[] values = new String[] { \”Android\”, \”iPhone\”, \”WindowsMobile\”,<br>        \”Blackberry\”, \”WebOS\”, \”Ubuntu\”, \”Windows7\”, \”Max OS X\”,<br>        \”Linux\”, \”OS/2\” };<br>    setListAdapter(new MyPerformanceArrayAdapter(this, values));<br>  }<br><br>}</pre><br>&nbsp;<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"tutorial_twolistitems\""></a>13. Tutorial: How to display two items in a ListView<br><br></div><br>You can use the <code>SimpleAdapter</code> class to show the data of two elements. This class expects a Array of Strings (<code>from</code>data) in which the fields of the input data are defined. It also requires a Array of ints which defines the IDs of the widgets in the layout for the row to which these fields are mapped.<br><br>The actual data is then a list of Maps. The Map defines for each field in the from data a value.<br><br>The following shows an example which reuses an predefined layout from Android for the row.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import java.util.ArrayList;<br>import java.util.HashMap;<br>import java.util.Map;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.widget.SimpleAdapter;<br><br>public class MyTwoListItemsActivity extends ListActivity {<br>  protected void onCreate(Bundle savedInstanceState) {<br>    super.onCreate(savedInstanceState);<br>    ArrayList&lt;Map&lt;String, String&gt;&gt; list = buildData();<br>    String[] from = { \”name\”, \”purpose\” };<br>    int[] to = { android.R.id.text1, android.R.id.text2 };<br><br>    SimpleAdapter adapter = new SimpleAdapter(this, list,<br>        android.R.layout.simple_list_item_2, from, to);<br>    setListAdapter(adapter);<br>  }<br><br>  private ArrayList&lt;Map&lt;String, String&gt;&gt; buildData() {<br>    ArrayList&lt;Map&lt;String, String&gt;&gt; list = new ArrayList&lt;Map&lt;String, String&gt;&gt;();<br>    list.add(putData(\”Android\”, \”Mobile\”));<br>    list.add(putData(\”Windows7\”, \”Windows7\”));<br>    list.add(putData(\”iPhone\”, \”iPhone\”));<br>    return list;<br>  }<br><br>  private HashMap&lt;String, String&gt; putData(String name, String purpose) {<br>    HashMap&lt;String, String&gt; item = new HashMap&lt;String, String&gt;();<br>    item.put(\”name\”, name);<br>    item.put(\”purpose\”, purpose);<br>    return item;<br>  }<br><br>}</pre><br>&nbsp;<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"listviewselection\""></a>14. Selecting multiple items in the ListView<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listviewselection_data\""></a>14.1. Interaction between the model and Listview<br><br></div><br>Frequently you need to select items in your <code>ListView</code>. As the row of the <code>ListView</code> are getting recycled you cannot store the selection on the <code>View</code> level.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br>Selection is just one possible example but you can imange other interaction between your row and model.<br><br>To persist the selection you have to update your data model with the selected state.<br><br>To update the data model in your <code>ListView</code> you define your own <code>Adapter</code> class. In this adapter class you attach a listener to the <code>View</code> which is responsible for selecting the model element. If selected you update the state in the model which you can add as a tag to the View to have access to it.<br><br>The following example demonstrates how to use standard Java object and how to interact from the <code>Views</code> with the model.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"listadvanced_interactive\""></a>14.2. Tutorial: Domain Model and Rows interaction<br><br></div><br>Continue to use the <code>de.vogella.android.listactivity</code> project.<br><br>Create the following <code>Model</code> which hold the name and the information if this element is currently selected.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>public class Model {<br><br>  private String name;<br>  private boolean selected;<br><br>  public Model(String name) {<br>    this.name = name;<br>    selected = false;<br>  }<br><br>  public String getName() {<br>    return name;<br>  }<br><br>  public void setName(String name) {<br>    this.name = name;<br>  }<br><br>  public boolean isSelected() {<br>    return selected;<br>  }<br><br>  public void setSelected(boolean selected) {<br>    this.selected = selected;<br>  }<br>}</pre><br>&nbsp;<br><br>Create the following new layout file called <code>rowbuttonlayout.xml</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;?xml version=\”1.0\” encoding=\”utf-8\”?&gt;<br>&lt;RelativeLayout xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    android:layout<em>width=\”match_parent\”<br>    android:layout_height=\”wrap_content\” &gt;<br><br>    &lt;TextView<br>        android:id=\”@+id/label\”<br>        android:layout_width=\”wrap_content\”<br>        android:layout_height=\”wrap_content\”<br>        android:text=\”@+id/label\”<br>        android:textSize=\”30px\” &gt;<br>    &lt;/TextView&gt;<br><br>    &lt;CheckBox<br>        android:id=\”@+id/check\”<br>        android:layout_width=\”wrap_content\”<br>        android:layout_height=\”wrap_content\”<br>        android:layout_alignParentRight=\”true\”<br>        android:layout_marginLeft=\”4px\”<br>        android:layout_marginRight=\”10px\” &gt;<br>    &lt;/CheckBox&gt;<br><br>&lt;/RelativeLayout&gt;</em></pre><br>&nbsp;<br><br>Create the following <code>Adapter</code>. This adapter adds a listener on the <code>Checkbox</code> view . If the checkbox is selected the underlying data of the model is changed. <code>Checkbox</code> gets the corresponding model element assigned via the<code>getTag()</code> method.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import java.util.List;<br><br>import android.app.Activity;<br>import android.view.LayoutInflater;<br>import android.view.View;<br>import android.view.ViewGroup;<br>import android.widget.ArrayAdapter;<br>import android.widget.CheckBox;<br>import android.widget.CompoundButton;<br>import android.widget.TextView;<br><br>public class InteractiveArrayAdapter extends ArrayAdapter&lt;Model&gt; {<br><br>  private final List&lt;Model&gt; list;<br>  private final Activity context;<br><br>  public InteractiveArrayAdapter(Activity context, List&lt;Model&gt; list) {<br>    super(context, R.layout.rowbuttonlayout, list);<br>    this.context = context;<br>    this.list = list;<br>  }<br><br>  static class ViewHolder {<br>    protected TextView text;<br>    protected CheckBox checkbox;<br>  }<br><br>  @Override<br>  public View getView(int position, View convertView, ViewGroup parent) {<br>    View view = null;<br>    if (convertView == null) {<br>      LayoutInflater inflator = context.getLayoutInflater();<br>      view = inflator.inflate(R.layout.rowbuttonlayout, null);<br>      final ViewHolder viewHolder = new ViewHolder();<br>      viewHolder.text = (TextView) view.findViewById(R.id.label);<br>      viewHolder.checkbox = (CheckBox) view.findViewById(R.id.check);<br>      viewHolder.checkbox<br>          .setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {<br><br>            @Override<br>            public void onCheckedChanged(CompoundButton buttonView,<br>                boolean isChecked) {<br>              Model element = (Model) viewHolder.checkbox<br>                  .getTag();<br>              element.setSelected(buttonView.isChecked());<br><br>            }<br>          });<br>      view.setTag(viewHolder);<br>      viewHolder.checkbox.setTag(list.get(position));<br>    } else {<br>      view = convertView;<br>      ((ViewHolder) view.getTag()).checkbox.setTag(list.get(position));<br>    }<br>    ViewHolder holder = (ViewHolder) view.getTag();<br>    holder.text.setText(list.get(position).getName());<br>    holder.checkbox.setChecked(list.get(position).isSelected());<br>    return view;<br>  }<br>}</pre><br>&nbsp;<br><br>Finally change your _activity to the following.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import java.util.ArrayList;<br>import java.util.List;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.widget.ArrayAdapter;<br><br>public class MyList extends ListActivity {<br><br>/<em>* Called when the activity is first created. </em>/<br><br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    // create an array of Strings, that will be put to our ListActivity<br>    ArrayAdapter&lt;Model&gt; adapter = new InteractiveArrayAdapter(this,<br>        getModel());<br>    setListAdapter(adapter);<br>  }<br><br>  private List&lt;Model&gt; getModel() {<br>    List&lt;Model&gt; list = new ArrayList&lt;Model&gt;();<br>    list.add(get(\”Linux\”));<br>    list.add(get(\”Windows7\”));<br>    list.add(get(\”Suse\”));<br>    list.add(get(\”Eclipse\”));<br>    list.add(get(\”Ubuntu\”));<br>    list.add(get(\”Solaris\”));<br>    list.add(get(\”Android\”));<br>    list.add(get(\”iPhone\”));<br>    // Initially select one of the items<br>    list.get(1).setSelected(true);<br>    return list;<br>  }<br><br>  private Model get(String s) {<br>    return new Model(s);<br>  }<br><br>}</pre><br><div class="\"hl-tag\"" style="\"color:" #008800;\"=""></div><br>If you start your app you should be able to flag items. These changes will be reflected in your model.<br><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"expandablelistview\""></a>15. Implementing an expandable ListView<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"expandablelistview_concept\""></a>15.1. ExpandableListView<br><br></div><br>The <code>ExpandableListView</code> is similar to <code>ListView</code> but allow you to define groups and details for this group.<code>ExpandableListView</code> expects and adapter of type <code>BaseExpandableListAdapter</code>.<br><br>In this case you have to define two layouts, one for the group and another one for the details row.<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"expandablelistview_example\""></a>15.2. ExpandableListView example<br><br></div><br>In the following example you create an expandable listview similar to the following screenshot.<br><br>&nbsp;<br><div class="\"mediaobject\""><img src="\" alt="\"></div><br>&nbsp;<br><br>Create a project called <em>com.vogella.android.listview.expandable</em> with the activity called <code>MainActivity</code>.<br><br>Create or adjust the following layout files. First <code>layout/activity_main.xml</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;LinearLayout xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    xmlns:tools=\”<a href="http://schemas.android.com/tools\" target="_blank" rel="external">http://schemas.android.com/tools\</a>“<br>    android:id=\”@+id/LinearLayout1\”<br>    android:layout_width=\”match_parent\”<br>    android:layout_height=\”match_parent\”<br>    android:paddingBottom=\”@dimen/activity_vertical_margin\”<br>    android:paddingLeft=\”@dimen/activity_horizontal_margin\”<br>    android:paddingRight=\”@dimen/activity_horizontal_margin\”<br>    android:paddingTop=\”@dimen/activity_vertical_margin\”<br>    tools:context=\”.MainActivity\” &gt;<br><br>    &lt;ExpandableListView<br>        android:id=\”@+id/listView\”<br>        android:layout_width=\”match_parent\”<br>        android:layout_height=\”wrap_content\” &gt;<br>    &lt;/ExpandableListView&gt;<br><br>&lt;/LinearLayout&gt;</pre><br>&nbsp;<br><br>Afterwards create <code>layout/listrow_group.xml</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;CheckedTextView xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    xmlns:tools=\”<a href="http://schemas.android.com/tools\" target="_blank" rel="external">http://schemas.android.com/tools\</a>“<br>    android:id=\”@+id/textView1\”<br>    android:layout_width=\”wrap_content\”<br>    android:layout_height=\”?android:attr/listPreferredItemHeight\”<br>    android:layout_marginLeft=\”8dp\”<br>    android:drawableRight=\”@drawable/ic_launcher\”<br>    android:gravity=\”left\”<br>    android:paddingLeft=\”32dp\”<br>    android:paddingTop=\”8dp\”<br>    android:text=\”Test\”<br>    android:textSize=\”14sp\”<br>    android:textAlignment=\”textEnd\”<br>    android:textStyle=\”bold\” /&gt;</pre><br>&nbsp;<br><br>The last required layout is <code>layout/listrow_details.xml</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">&lt;LinearLayout xmlns:android=\”<a href="http://schemas.android.com/apk/res/android\" target="_blank" rel="external">http://schemas.android.com/apk/res/android\</a>“<br>    xmlns:tools=\”<a href="http://schemas.android.com/tools\" target="_blank" rel="external">http://schemas.android.com/tools\</a>“<br>    android:layout_width=\”match_parent\”<br>    android:layout_height=\”40dp\”<br>    android:clickable=\”true\”<br>    android:orientation=\”vertical\”<br>    android:paddingLeft=\”40dp\”<br>    tools:context=\”.MainActivity\” &gt;<br><br>    &lt;TextView<br>        android:id=\”@+id/textView1\”<br>        android:layout_width=\”wrap_content\”<br>        android:layout_height=\”wrap_content\”<br>        android:drawableLeft=\”@drawable/ic_launcher\”<br>        android:drawablePadding=\”5dp\”<br>        android:gravity=\”center_vertical\”<br>        android:text=\”@string/hello_world\”<br>        android:textSize=\”14sp\”<br>        android:textStyle=\”bold\” &gt;<br>    &lt;/TextView&gt;<br><br>    &lt;View<br>        android:layout_width=\”match_parent\”<br>        android:layout_height=\”1dp\”<br>        android:background=\”@android:color/black\” /&gt;<br><br>&lt;/LinearLayout&gt;</pre><br>&nbsp;<br><br>Create the following class which hold your domain model for the <code>ExpandableListView</code>.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package com.vogella.android.listview.expandable;<br><br>import java.util.ArrayList;<br>import java.util.List;<br><br>public class Group {<br><br>  public String string;<br>  public final List&lt;String&gt; children = new ArrayList&lt;String&gt;();<br><br>  public Group(String string) {<br>    this.string = string;<br>  }<br><br>}</pre><br>&nbsp;<br><br>Finally create the adapter as described by the following listing and change the activity to the code provided below.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package com.vogella.android.listview.expandable;<br><br>import android.app.Activity;<br>import android.util.SparseArray;<br>import android.view.LayoutInflater;<br>import android.view.View;<br>import android.view.View.OnClickListener;<br>import android.view.ViewGroup;<br>import android.widget.BaseExpandableListAdapter;<br>import android.widget.CheckedTextView;<br>import android.widget.TextView;<br>import android.widget.Toast;<br><br>public class MyExpandableListAdapter extends BaseExpandableListAdapter {<br><br>  private final SparseArray&lt;Group&gt; groups;<br>  public LayoutInflater inflater;<br>  public Activity activity;<br><br>  public MyExpandableListAdapter(Activity act, SparseArray&lt;Group&gt; groups) {<br>    activity = act;<br>    this.groups = groups;<br>    inflater = act.getLayoutInflater();<br>  }<br><br>  @Override<br>  public Object getChild(int groupPosition, int childPosition) {<br>    return groups.get(groupPosition).children.get(childPosition);<br>  }<br><br>  @Override<br>  public long getChildId(int groupPosition, int childPosition) {<br>    return 0;<br>  }<br><br>  @Override<br>  public View getChildView(int groupPosition, final int childPosition,<br>      boolean isLastChild, View convertView, ViewGroup parent) {<br>    final String children = (String) getChild(groupPosition, childPosition);<br>    TextView text = null;<br>    if (convertView == null) {<br>      convertView = inflater.inflate(R.layout.listrow_details, null);<br>    }<br>    text = (TextView) convertView.findViewById(R.id.textView1);<br>    text.setText(children);<br>    convertView.setOnClickListener(new OnClickListener() {<br>      @Override<br>      public void onClick(View v) {<br>        Toast.makeText(activity, children,<br>            Toast.LENGTH_SHORT).show();<br>      }<br>    });<br>    return convertView;<br>  }<br><br>  @Override<br>  public int getChildrenCount(int groupPosition) {<br>    return groups.get(groupPosition).children.size();<br>  }<br><br>  @Override<br>  public Object getGroup(int groupPosition) {<br>    return groups.get(groupPosition);<br>  }<br><br>  @Override<br>  public int getGroupCount() {<br>    return groups.size();<br>  }<br><br>  @Override<br>  public void onGroupCollapsed(int groupPosition) {<br>    super.onGroupCollapsed(groupPosition);<br>  }<br><br>  @Override<br>  public void onGroupExpanded(int groupPosition) {<br>    super.onGroupExpanded(groupPosition);<br>  }<br><br>  @Override<br>  public long getGroupId(int groupPosition) {<br>    return 0;<br>  }<br><br>  @Override<br>  public View getGroupView(int groupPosition, boolean isExpanded,<br>      View convertView, ViewGroup parent) {<br>    if (convertView == null) {<br>      convertView = inflater.inflate(R.layout.listrow_group, null);<br>    }<br>    Group group = (Group) getGroup(groupPosition);<br>    ((CheckedTextView) convertView).setText(group.string);<br>    ((CheckedTextView) convertView).setChecked(isExpanded);<br>    return convertView;<br>  }<br><br>  @Override<br>  public boolean hasStableIds() {<br>    return false;<br>  }<br><br>  @Override<br>  public boolean isChildSelectable(int groupPosition, int childPosition) {<br>    return false;<br>  }<br>}</pre><br>&nbsp;<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package com.vogella.android.listview.expandable;<br><br>import java.util.ArrayList;<br><br>import android.app.Activity;<br>import android.os.Bundle;<br>import android.util.SparseArray;<br>import android.view.Menu;<br>import android.widget.ExpandableListView;<br><br>public class MainActivity extends Activity {<br>  // more efficient than HashMap for mapping integers to objects<br>  SparseArray&lt;Group&gt; groups = new SparseArray&lt;Group&gt;();<br><br>  @Override<br>  protected void onCreate(Bundle savedInstanceState) {<br>    super.onCreate(savedInstanceState);<br>    setContentView(R.layout.activity_main);<br>    createData();<br>    ExpandableListView listView = (ExpandableListView) findViewById(R.id.listView);<br>    MyExpandableListAdapter adapter = new MyExpandableListAdapter(this,<br>        groups);<br>    listView.setAdapter(adapter);<br>  }<br><br>  public void createData() {<br>    for (int j = 0; j &lt; 5; j++) {<br>      Group group = new Group(\”Test \” + j);<br>      for (int i = 0; i &lt; 5; i++) {<br>        group.children.add(\”Sub Item\” + i);<br>      }<br>      groups.append(j, group);<br>    }<br>  }<br><br>}</pre><br>&nbsp;<br><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"miscellaneous\""></a>16. Tutorial: Miscellaneous<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"miscellaneous_longclick\""></a>16.1. Adding a longclick listener to the list items<br><br></div><br>You can also add a <code>LongItemClickListener</code> to the <code>View</code>. For this receive the <code>ListView</code> via the <code>getListVIew()</code> method and set the <code>LongItemClickListener</code> via the setOnItemLongClickListener() method.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity;<br><br>import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.view.View;<br>import android.widget.AdapterView;<br>import android.widget.AdapterView.OnItemLongClickListener;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br>import android.widget.Toast;<br><br>public class MyList extends ListActivity {<br><br>/<strong> Called when the activity is first created. */<br><br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    // create an array of Strings, that will be put to our ListActivity<br>    String[] names = new String[] { \”Linux\”, \”Windows7\”, \”Eclipse\”, \”Suse\”,<br>        \”Ubuntu\”, \”Solaris\”, \”Android\”, \”iPhone\” };<br>    ArrayAdapter&lt;String&gt; adapter = new MyPerformanceArrayAdapter(this, names);<br>    setListAdapter(adapter);<br>    ListView list = getListView();<br>    list.setOnItemLongClickListener(new OnItemLongClickListener() {<br><br>      @Override<br>      public boolean onItemLongClick(AdapterView&lt;?&gt; parent, View view,<br>          int position, long id) {<br>        Toast.makeText(MyList.this,<br>            \”Item in position \” + position + \” clicked\”,<br>            Toast.LENGTH_LONG).show();<br>        // Return true to consume the click event. In this case the<br>        // onListItemClick listener is not called anymore.<br>        return true;<br>      }<br>    });<br>  }<br><br>  @Override<br>  protected void onListItemClick(ListView l, View v, int position, long id) {<br>    super.onListItemClick(l, v, position, id);<br>    // Get the item that was clicked<br>    Object o = this.getListAdapter().getItem(position);<br>    String keyword = o.toString();<br>    Toast.makeText(this, \”You selected: \” + keyword, Toast.LENGTH_SHORT)<br>        .show();<br><br>  }<br><br>}</strong></pre><br><div class="\"hl-tag\"" style="\"color:" #008800;\"=""></div><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"miscellaneous_headerfooter\""></a>16.2. Header and Footer<br><br></div><br>You can of course put arbitrary <code>Views</code> elements around your ListView. For example you can define a layout with two<code>TextViews</code> and a <code>ListView</code> between them. In this case the two TextViews will always be visible above the List (header) and the other will be visible below the ListView. If you want to display a list header or list footer only at the see the beginning or end of the list you can use the <code>addHeaderView()</code> method or <code>addFooterView()</code> method on the<code>ListView</code> class.<br><br>package de.vogella.android.listactivity;<br><pre class="\"lang:java" decode:true="" programlisting\"="">import android.app.ListActivity;<br>import android.os.Bundle;<br>import android.view.View;<br>import android.widget.ArrayAdapter;<br>import android.widget.ListView;<br><br>public class MyList extends ListActivity {<br><br>/ Called when the activity is first created. */<br><br>  public void onCreate(Bundle icicle) {<br>    super.onCreate(icicle);<br>    // create an array of Strings, that will be put to our ListActivity<br>    String[] names = new String[] { \”Linux\”, \”Windows7\”, \”Eclipse\”, \”Suse\”,<br>        \”Ubuntu\”, \”Solaris\”, \”Android\”, \”iPhone\”, \”Linux\”, \”Windows7\”,<br>        \”Eclipse\”, \”Suse\”, \”Ubuntu\”, \”Solaris\”, \”Android\”, \”iPhone\” };<br>    View header = getLayoutInflater().inflate(R.layout.header, null);<br>    View footer = getLayoutInflater().inflate(R.layout.footer, null);<br>    ListView listView = getListView();<br>    listView.addHeaderView(header);<br>    listView.addFooterView(footer);<br>    setListAdapter(new ArrayAdapter&lt;String&gt;(this,<br>        android.R.layout.simple_list_item_single_choice,<br>        android.R.id.text1, names));<br><br>  }<br>}</pre><br></div><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"cursor\""></a>17. SimpleCursorAdapter<br><br></div><br>In case you work with a content provider or directly with the database you can use the <code>SimpleCursorAdapter</code> to define the data for your <code>ListView</code>. The following will demonstrates how to access the Contacts ContentProvider.<br><br>Create a new Android project called \”de.vogella.android.listactivity.cursor\” with the <em>activity</em> called <em>MyListActivity</em>. Change <code>MyListActivity</code> to the following.<br><br>&nbsp;<br><pre class="\"lang:java" decode:true="" programlisting\"="">package de.vogella.android.listactivity.cursor;<br><br>import android.app.ListActivity;<br>import android.database.Cursor;<br>import android.net.Uri;<br>import android.os.Bundle;<br>import android.provider.ContactsContract;<br>import android.widget.ListAdapter;<br>import android.widget.SimpleCursorAdapter;<br><br>public class MyListActivity extends ListActivity {<br><br>/<em>* Called when the activity is first created. </em>/<br><br>  @Override<br>  public void onCreate(Bundle savedInstanceState) {<br>    super.onCreate(savedInstanceState);<br>    Cursor mCursor = getContacts();<br>    startManagingCursor(mCursor);<br>    // now create a new list adapter bound to the cursor.<br>    // SimpleListAdapter is designed for binding to a Cursor.<br>    ListAdapter adapter = new SimpleCursorAdapter(this, // Context.<br>        android.R.layout.two_line_list_item, // Specify the row template<br>                            // to use (here, two<br>                            // columns bound to the<br>                            // two retrieved cursor<br>                            // rows).<br>        mCursor, // Pass in the cursor to bind to.<br>        // Array of cursor columns to bind to.<br>        new String[] { ContactsContract.Contacts._ID,<br>            ContactsContract.Contacts.DISPLAY_NAME },<br>        // Parallel array of which template objects to bind to those<br>        // columns.<br>        new int[] { android.R.id.text1, android.R.id.text2 });<br><br>    // Bind to our new adapter.<br>    setListAdapter(adapter);<br>  }<br><br>  private Cursor getContacts() {<br>    // Run query<br>    Uri uri = ContactsContract.Contacts.CONTENT_URI;<br>    String[] projection = new String[] { ContactsContract.Contacts._ID,<br>        ContactsContract.Contacts.DISPLAY_NAME };<br>    String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + \” = \’\”<br>        + (\”1\”) + \”\’\”;<br>    String[] selectionArgs = null;<br>    String sortOrder = ContactsContract.Contacts.DISPLAY_NAME<br>        + \” COLLATE LOCALIZED ASC\”;<br><br>    return managedQuery(uri, projection, selection, selectionArgs,<br>        sortOrder);<br>  }<br><br>}<br></pre><br><div class="\"hl-tag\"" style="\"color:" #008800;\"=""></div><br>Make sure you give your application the permission to read the contacts. (Uses Permissions \”android.permission.READ_CONTACTS\” in AndroidManifest.xml)<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"actionbar_libraries\""></a>18. Additional Open Source libraries<br><br></div><br>Sometimes having to press a refresh button on the ActionBar to refresh data can be annoying for the user. Chris Banes has implemented an Open Source library to implement the pull to refresh pattern for a <code>Listview</code>. <a href="https://github.com/chrisbanes/Android-PullToRefresh" target="_blank" rel="external">https://github.com/chrisbanes/Android-PullToRefresh</a>.<br><br>Also you may want to use the swipe to dismiss gesture to delete items from a ListView. Roman Nurik provides an example for this at <a href="\">Android swipe-to-dismiss library</a> which Jake Wharton backported to earlier Android releases at <a href="\">SwipeToDismissNOA</a>.<br><br></div>

<div class="\"section\"" style="\"color:" #000000;\"=""><br><div class="\"titlepage\""><br><br>## <a style="\"color:" #101010;\"="" name="\"thankyou\""></a>19. Support free vogella tutorials<br><br></div><br>Maintaining high quality free online tutorials is a lot of work. Please support free tutorials by donating or by reporting typos and factual errors.<br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"thankyou\""></a>19.1. Thank you<br><br></div><br><div class="\"titlepage\""><br><br>## 20. Links and Literature<br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"sourcecode\""></a>20.1. Source Code<br><br></div><br><a href="\">Source Code of Examples</a><br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"resources_listview\""></a>20.2. ListView Resources<br><br></div><br><a href="\">ListView demo which uses 3D effects (Github)</a><br><br><a href="\">ListView with section headers (Github)</a><br><br></div><br><div class="\"section\""><br><div class="\"titlepage\""><br><br>### <a style="\"color:" #101010;\"="" name="\"resources_general\""></a>20.3. vogella Resources<br><br></div><br><a href="\">vogella Training</a> Android and Eclipse Training from the vogella team<br><br><a href="\">Android Tutorial</a> Introduction to Android Programming<br><br><a href="\">GWT Tutorial</a> Program in Java, compile to JavaScript and HTML<br><br><a href="\">Eclipse RCP Tutorial</a> Create native applications in Java<br><br><a href="\">JUnit Tutorial</a> Test your application<br><br><a href="\">Git Tutorial</a> Put all your files in a distributed version control system<br><br></div><br>&nbsp;<br><br>&nbsp;<br><br>Please consider a contribution if this article helped you.<br><br></div><br></div>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-android-tips-round-up-2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/05/31/android-tips-round-up-2/" class="article-date">
  	<time datetime="2014-05-31T10:20:47.000Z" itemprop="datePublished">2014-05-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/31/android-tips-round-up-2/">[译]Android小技巧(2)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言">前言</h2><p>本文是一篇译文,这篇是这个系列的第二篇.讲述的是Android开发中遇到的一些好用的小技巧,或者一些实用的API,很多人都知道,但也有人不知道,记录下来,如果能帮助到大家,也是极好的.由于不是严格的博文,所以翻译也不那么严格,有些工具和类我也会经常用,所以我会根据自己的想法去写.有些地方坐在并没有将这个工具的作用讲出来,我会补充上去.</p>
<h2 id="正文">正文</h2><p><a href="http://developer.android.com/reference/android/text/format/DateUtils.html#formatDateTime%28android.content.Context,%20long,%20int%29" target="_blank" rel="external">DateUtils.formatDateTime()</a> 用来进行区域格式化工作,输出格式化和本地化的时间或者日期.</p>
<p><a href="http://developer.android.com/reference/android/app/AlarmManager.html#setInexactRepeating(int, long, long, android.app.PendingIntent" target="_blank" rel="external">AlarmManager.setInexactRepeating</a>) 通过闹铃分组的方式省电,即使你只调用了一个闹钟,这也是一个好的选择,（可以确保在使用完毕时自动调用 AlarmManager.cancel ()。原文说的比较抽象,这里详细说一下:setInexactRepeating指的是设置非准确闹钟,使用方法:alarmManager.setInexactRepeating(AlarmManager.RTC, startTime,intervalL, pendingIntent),非准确闹钟只能保证大致的时间间隔，但是不一定准确，可能出现设置间隔为30分钟，但是实际上一次间隔20分钟，另一次间隔40分钟。它的最大的好处是可以合并闹钟事件，比如间隔设置每30分钟一次，不唤醒休眠，在休眠8小时后已经积累了16个闹钟事件，而在手机被唤醒的时候，非准时闹钟可以把16个事件合并为一个, 所以这么看来,非准时闹钟一般来说比较节约能源.</p>
<p><a href="http://developer.android.com/reference/android/text/format/Formatter.html#formatFileSize(android.content.Context, long" target="_blank" rel="external">Formatter.formatFileSize()</a>) 一个区域化的文件大小格式化工具。通俗来说就是把大小转换为MB,G,KB之类的字符串.</p>
<p><a href="http://developer.android.com/reference/android/app/ActionBar.html#hide(" target="_blank" rel="external">ActionBar.hide()</a>)/<a href="http://developer.android.com/reference/android/app/ActionBar.html#show(" target="_blank" rel="external">.show()</a>) 顾名思义,隐藏和显示ActionBar,可以优雅地在全屏和带Actionbar之间转换.</p>
<p><a href="http://developer.android.com/reference/android/text/util/Linkify.html#addLinks(android.text.Spannable, int" target="_blank" rel="external">Linkify.addLinks()</a>)  在Text上添加链接.很实用.</p>
<p><a href="http://developer.android.com/reference/android/text/StaticLayout.html" target="_blank" rel="external">StaticLayout</a> 在自定义 View 中渲染文字的时候很实用。</p>
<p><a href="http://developer.android.com/reference/android/app/Activity.html#onBackPressed(" target="_blank" rel="external">Activity.onBackPressed()</a>) 很方便的管理back键的方法,有时候需要自己控制返回键的事件的时候,可以重写一下.比如加入 “点两下back键退出” 功能.</p>
<p><a href="http://developer.android.com/reference/android/view/GestureDetector.html" target="_blank" rel="external">GestureDetector</a> 用来监听和相应对应的手势事件,比如点击,长按,慢滑动,快滑动,用起来很简单,比你自己实现要方便许多.</p>
<p><a href="http://developer.android.com/reference/android/graphics/DrawFilter.html" target="_blank" rel="external">DrawFilter</a> 可以让你在不调用onDrew方法的情况下,操作canvas,比了个如,你可以在创建自定义 View 的时候设置一个 DrawFilter，给父 View 里面的所有 View 设置反别名。</p>
<p><a href="http://developer.android.com/reference/android/app/ActivityManager.html#getMemoryClass(" target="_blank" rel="external">ActivityManager.getMemoryClass()</a>) 告诉你你的机器还有多少内存,在计算缓存大小的时候会比较有用.</p>
<p><a href="http://developer.android.com/reference/android/view/ViewStub.html" target="_blank" rel="external">ViewStub</a> 它是一个初始化不做任何事情的 View，但是之后可以载入一个布局文件。在慢加载 View 中很适合做占位符。唯一的缺点就是不支持标签，所以如果你不太小心的话，可能会在视图结构中加入不需要的嵌套。</p>
<p><a href="http://developer.android.com/reference/android/os/SystemClock.html#sleep(long" target="_blank" rel="external">SystemClock.sleep()</a>) 这个方法在保证一定时间的 sleep 时很方便，通常我用来进行 debug 和模拟网络延时。</p>
<p><a href="http://developer.android.com/reference/android/util/DisplayMetrics.html#density" target="_blank" rel="external">DisplayMetrics.density</a> 这个方法你可以获取设备像素密度,大部分时候最好让系统来自动进行缩放资源之类的操作,但是有时候控制的效果会更好一些.(尤其是在自定义View的时候).</p>
<p><a href="http://developer.android.com/reference/android/util/Pair.html#create(A, B" target="_blank" rel="external">Pair.create()</a>) 方便构建类和构造器的方法。</p>
<h2 id="备忘">备忘</h2><p>More: <a href="http://www.androidperformance.com/android-tips-round-up.html" target="_blank" rel="external">Part1</a> , <a href="http://www.androidperformance.com/android-tips-round-up-2.html" target="_blank" rel="external">Part2</a> , <a href="http://www.androidperformance.com/android-tips-round-up-3.html" target="_blank" rel="external">Part3</a> , <a href="http://www.androidperformance.com/android-tips-round-up-4.html" target="_blank" rel="external">Part4</a>, <a href="http://www.androidperformance.com/android-tips-round-up-5.html" target="_blank" rel="external">Part5</a><br>原文地址:<a href="http://blog.danlew.net/2014/04/14/android-tips-round-up-part-2/" target="_blank" rel="external">http://blog.danlew.net/2014/03/30/android-tips-round-up-part-2/</a><br>原文作者:<a href="http://blog.danlew.net/about/" target="_blank" rel="external">http://blog.danlew.net/about/</a><br>本文地址:<a href="http://www.androidperformance.com/android-tips-round-up-2.html" target="_blank" rel="external">http://www.androidperformance.com/android-tips-round-up-2.html</a> 转载请注明.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-android-tips-round-up-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/05/28/android-tips-round-up-1/" class="article-date">
  	<time datetime="2014-05-28T15:47:43.000Z" itemprop="datePublished">2014-05-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/28/android-tips-round-up-1/">[译]Android小技巧(1)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言">前言</h2><p>本文是一篇译文,这篇是这个系列的第一篇.讲述的是Android开发中遇到的一些好用的小技巧,或者一些实用的API,很多人都知道,但也有人不知道,记录下来,如果能帮助到大家,也是极好的.由于不是严格的博文,所以翻译也不那么严格,有些工具和类我也会经常用,所以我会根据自己的想法去写.有些地方坐在并没有将这个工具的作用讲出来,我会补充上去.</p>
<h2 id="正文">正文</h2><p><a href="http://developer.android.com/reference/android/app/Activity.html#startActivities(android.content.Intent[]" target="_blank" rel="external">Activity.startActivities()</a>) 常用于在应用程序中间启动其他的Activity.</p>
<p><a href="http://developer.android.com/reference/android/text/TextUtils.html#isEmpty(java.lang.CharSequence" target="_blank" rel="external">TextUtils.isEmpty()</a>) 简单的工具类,用于检测是否为空</p>
<p><a href="http://developer.android.com/reference/android/text/Html.html#fromHtml(java.lang.String" target="_blank" rel="external">Html.fromHtml()</a>) 用于生成一个Html,参数可以是一个字符串.个人认为它不是很快,所以我不怎么经常去用.（我说不经常用它是为了重点突出这句话：请多手动构建 Spannable 来替换 Html.fromHtml），但是它对渲染从 web 上获取的文字还是很不错的。</p>
<p><a href="http://developer.android.com/reference/android/widget/TextView.html#setError%28java.lang.CharSequence%29" target="_blank" rel="external">TextView.setError()</a> 在验证用户输入的时候很棒</p>
<p><a href="http://developer.android.com/reference/android/os/Build.VERSION_CODES.html" target="_blank" rel="external">Build.VERSION_CODES</a> 这个标明了当前的版本号,在处理兼容性问题的时候经常会用到.点进去可以看到各个版本的不同特性</p>
<p><a href="http://developer.android.com/reference/android/util/Log.html#getStackTraceString(java.lang.Throwable" target="_blank" rel="external">Log.getStackTraceString()</a>) 方便的日志类工具,方法Log.v()、Log.d()、Log.i()、Log.w()和Log.e()都是将信息打印到LogCat中，有时候需要将出错的信息插入到数据库或一个自定义的日志文件中，那么这种情况就需要将出错的信息以字符串的形式返回来，也就是使用static String getStackTraceString(Throwable tr)方法的时候.</p>
<p><a href="http://developer.android.com/reference/android/view/LayoutInflater.html#from%28android.content.Context%29" target="_blank" rel="external">LayoutInflater.from()</a> 顾名思义,用于Inflate一个layout,参数是layout的id.这个经常写Adapter的人会用的比较多.</p>
<p><a href="http://developer.android.com/reference/android/view/ViewConfiguration.html#getScaledTouchSlop%28%29" target="_blank" rel="external">ViewConfiguration.getScaledTouchSlop()</a> 使用 ViewConfiguration 中提供的值以保证所有触摸的交互都是统一的。这个方法获取的值表示:用户的手滑动这个距离后,才判定为正在进行滑动.当然这个值也可以自己来决定.但是为了一致性,还是使用标准的值较好.</p>
<p><a href="http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html#convertKeypadLettersToDigits%28java.lang.String%29" target="_blank" rel="external">PhoneNumberUtils.convertKeypadLettersToDigits</a> 顾名思义.将字母转换为数字,类似于T9输入法,</p>
<p><a href="http://developer.android.com/reference/android/content/Context.html#getCacheDir%28%29" target="_blank" rel="external">Context.getCacheDir()</a> 获取缓存数据文件夹的路径,很简单但是知道的人不多,这个路径通常在SD卡上(这里的SD卡指的是广义上的SD卡,包括外部存储和内部存储)Adnroid/data/您的应用程序包名/cache/  下面.测试的时候,可以去这里面看是否缓存成功.缓存在这里的好处是:不用自己再去手动创建文件夹,不用担心用户把自己创建的文件夹删掉,在应用程序卸载的时候,这里会被清空,使用第三方的清理工具的时候,这里也会被清空.</p>
<p><a href="http://developer.android.com/reference/android/animation/ArgbEvaluator.html" target="_blank" rel="external">ArgbEvaluator</a> 用于处理颜色的渐变。就像 Chris Banes 说的一样，这个类会进行很多自动装箱的操作，所以最好还是去掉它的逻辑自己去实现它。这个没用过,不明其所以然,回头再补充.</p>
<p><a href="http://developer.android.com/reference/android/view/ContextThemeWrapper.html" target="_blank" rel="external">ContextThemeWrapper</a> 方便在运行的时候修改主题.</p>
<p><a href="http://developer.android.com/reference/android/widget/Space.html" target="_blank" rel="external">Space</a> space是Android 4.0中新增的一个控件，它实际上可以用来分隔不同的控件，其中形成一个空白的区域.这是一个轻量级的视图组件，它可以跳过Draw，对于需要占位符的任何场景来说都是很棒的。</p>
<p><a href="http://developer.android.com/reference/android/animation/ValueAnimator.html#reverse%28%29" target="_blank" rel="external">ValueAnimator.reverse()</a> 这个方法可以很顺利地取消正在运行的动画.我超喜欢.</p>
<h2 id="备忘">备忘</h2><p>More: <a href="http://www.androidperformance.com/android-tips-round-up.html" target="_blank" rel="external">Part1</a> , <a href="http://www.androidperformance.com/android-tips-round-up-2.html" target="_blank" rel="external">Part2</a> , <a href="http://www.androidperformance.com/android-tips-round-up-3.html" target="_blank" rel="external">Part3</a> , <a href="http://www.androidperformance.com/android-tips-round-up-4.html" target="_blank" rel="external">Part4</a>, <a href="http://www.androidperformance.com/android-tips-round-up-5.html" target="_blank" rel="external">Part5</a><br>原文地址:<a href="http://blog.danlew.net/2014/03/30/android-tips-round-up-part-1/" target="_blank" rel="external">http://blog.danlew.net/2014/03/30/android-tips-round-up-part-1/</a><br>原文作者:<a href="http://blog.danlew.net/about/" target="_blank" rel="external">http://blog.danlew.net/about/</a><br>本文地址:<a href="http://www.androidperformance.com/android-tips-round-up-1.html" target="_blank" rel="external">http://www.androidperformance.com/android-tips-round-up-1.html</a> 转载请注明.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-javamodifier" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/05/28/javamodifier/" class="article-date">
  	<time datetime="2014-05-28T12:14:59.000Z" itemprop="datePublished">2014-05-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/28/javamodifier/">JAVA修饰符</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <div style="color: #000000;font-family: 微软雅黑"><strong>java.lang.reflect.Modifier</strong><br><table><br><tbody><br><tr><br><td colspan="2"><strong>ABSTRACT</strong></td><br></tr><br><tr><br><td></td><br><td>Abstract(抽象)可以修饰类、方法。包含一个或多个抽象方法的类本身必须被声明为抽象类。除了抽象方法之外，抽象类还可以包含具体数据和具体方法。抽象方法充当着占位的角色，它们的具体实现在子类中。扩展抽象类可以有两种选择：一种是在子类中定义部分抽象方法或抽象方法也不定义，这样就必须将子类也标记为抽象类；另一种是定义全部的抽象方法，这样子类就不是抽象类了。<br><br>类即使不含有抽象方法也可以将类声明为抽象类。抽象类不能实例化。也就是说，如果将一个类声明为abstract，就不能创建这个类的对象。不过可以定义一个抽象类的对象变量，但是它只能引用继承抽象类的非抽象子类的对象。<br><br>注意比较：<br><strong>private void</strong> <strong>print(){}</strong>；此语句表示方法的空实现。<br><strong>Abstract void</strong> <strong>print()</strong>； 此语句表示方法的抽象，无实现。<br><br>Abstract和static或者Abstract和final不能放在一起，否则便会出现错误。<br><br>&nbsp;</td><br></tr><br><tr><br><td><strong>FINAL</strong></td><br><td></td><br></tr><br><tr><br><td></td><br><td>final可以修饰类，方法，域。<br>域被声明为final，则构造对象之后就不允许改变它们的值了。如果被修饰的域是对象引用，则对象内的值还是可以改变的，但是对象的引用不能改变。（必须初始化，不能被修改）<br>方法被声明为final，可以确保方法不会在子类中改变语义，就是说不能被子类覆盖。<br><br>PS：早期JAVA中，有时为了避免动态绑定带来的系统开销而使用final修饰符。如果一个方法很短并且没有被覆盖，编译器就能够对它进行优化处理，这个过程被称为内联（inlining）。例如，内联调用e.getName()将被替换为访问e.name域。这是由于CPU在处理调用方法的指令时，使用的分支转移会扰乱预取指令策略，增加系统开销，使用内联可以避免这一开销。但是，如果getName在另一个类中被覆盖，那么编译器就无法知道覆盖的代码将会做什么操作，因此就不能对它进行内敛处理了。<br><br>不过现在虚拟机中的即时编译器比传统编译器的处理能力要强得多。这种编译器可以准确地知道类之间的继承关系，并能够检测出类中是否真正地存在覆盖给定的方法。如果方法简短，被调用频繁而且没有真正地被覆盖，那么即时编译器就会对这个方法进行内联处理。如果虚拟机加载了另一个类，而在这个类中包含对内联方法的覆盖，那么优化器将取消对覆盖方法的内联。这过程很慢而且很少发生。<br><br>类被声明为final，相当于其中的方法自动成为final方法，但是不包括类中的域。这种操作可以阻止利用被修饰的类定义子类。就是说不允许被继承的类被称为final类。一般来说一个类要么为继承设计，并提供文档说明；要么就禁止继承，成为一个final类。<br><br>&nbsp;</td><br></tr><br><tr><br><td colspan="2"><strong>INTERFACE</strong></td><br></tr><br><tr><br><td></td><br><td>在JAVA语言中，接口不是类，而是对类的一组需求描述，这些类要遵从接口描述的统一格式进行定义。公开接口与类相似，一个文件只能有一个public接口，且与文件名相同。 在一个文件中不可同时定义一个public接口和一个public类。<br><br>接口中可以包含多个方法，也可以定义常量。接口中所有方法自动属于public和abstract，所以不能在接口中实现方法。在接口中声明方法时不必提供修饰符public，但在类实现接口时public不可省略，如果省去public则在编译的时候提示出错。而且类要实现接口中所有的方法否则类就是一个抽象类。接口中可以定义常量，常量自动具有public，static，final属性。接口决不能含有实例域，可以将接口看成是没有实例域的抽象类。<br><br>接口不是类，不能使用new运算法实例化一个接口，虽然不能构造接口的对象，但可以声明接口的变量，接口变量必须引用实现了接口的类的对象。接口可以像建立继承关系一样，形成一条或多条从较高通用性到较高专用性的接口链。要注意接口继承接口使用关键字<strong>extends</strong>，并且可以进行多继承。类实现接口使用关键字<strong>implements</strong>，可以实现多个接口，并同时继承一个且最多一个超类。<br><br>接口与抽象类：一个类可以实现多个接口，但是一个类只能有一个超类。类与超类的关系是“is-a”，类与被实现接口的关系是“like-a”。抽象类可以包含据体数据和具体方法，接口只能包含常量和抽象方法。<br>PS：可以使用instanceof检查一个对象是否属于某个特定的类，也可以使用instanceof检查一个对象是否实现了某个特定的接口。<br><br>&nbsp;</td><br></tr><br><tr><br><td><strong>NATIVE</strong></td><br><td></td><br></tr><br><tr><br><td></td><br><td>JAVA编程语言使用关键字native提醒编译器被修饰的方法将在外部定义，而且方法标题后直接跟分号，这种声明方式和抽象方法类似。<br><pre class="lang:java decode:true ">class HelloNative{<br>    public native void greeting();<br>}<br></pre><br>如果一个含有本地方法的类被继承，子类会继承这个本地方法并且可以用java语言重写这个方法。本地方法非常有用，因为它有效地扩充了jvm。事实上，我们所写的java代码已经用到了本地方法，在sun的java的并发（多线程）的机制实现中，许多与操作系统的接触点都用到了本地方法，这使得java程序能够超越java运行时的界限。有了本地方法，java程序可以做任何应用层次的任务。<br>PS：通过java.system.loadLibrary()方法装载含有本地方法的库。<br><br>&nbsp;</td><br></tr><br><tr><br><td colspan="2"><strong>PRIVATE，PROTECTED，PUBLIC</strong></td><br></tr><br><tr><br><td></td><br><td>这三个修饰符都是用来控制类和成员的访问级别。还有一个访问级别叫做包级私有（package-private），也就是没有修饰符修饰缺省（default）的访问级别。<br><br>对于顶层的类（非嵌套的类）和接口，只有两种可能的访问级别：包级私有的（package-private）和公有的（public）。如果使用public修饰符声明了顶层类或者接口，那它就是公有的；否则就是包级私有的。<br>如果类或者接口能够被做成包级私有的，它就应该被做成包级私有的。通过把类或者接口做成包级私有，它实际上成了这个包的实现的一部分，而不是该包导出API的一部分，在以后的发行版本中，可以对它进行修改，替换或者删除，而无需担心会影响到现有客户端程序。如果把它做成公有的，你就有责任永远支持它，以保持它们的兼容性。<br>如果一个包级私有的顶层类（或者接口）只是在某个类的内部被用到，就应该考虑使它成为唯一使用它的那个类的私有嵌套类。这样可以将它的可访问范围从包中所有类缩小到了使用它的那个类。然而，降低不必要公有类的可访问性，比降低包级私有的顶层类的可访问性重要得多：因为公有类是包的API的一部分，而包级私有的顶层类则已经是这个包的实现的一部分。<br><br>对于成员（域，方法，嵌套类和嵌套接口）有四种可能的访问级别，下面按照可访问性的递增顺序罗列出来：<br><br><em>   私有的（private） —— 只有在声明该成员的顶层类内部才可以访问这个成员。
</em>   包级私有（package-private） —— 声明该成员的包内部的任何类都可以访问这个成员。从技术上讲，它被称为“缺省（default）访问级别”，如果没有为成员指定访问修饰符，就采用这个访问级别。<br><em>   受保护的（protected） —— 声明该成员的类的子类可以访问这个成员，并且，声明该成员的包内部的任何类可以访问这个成员。（分为在同一个包内和不在同一个包内）
</em>   公有的（public） —— 在任何地方都可以访问该成员<br>在设计一个类时，只有当同一个包内部的另一个类真正需要访问一个成员的时候，你才应该删除private修饰符，使该成员变成包级私有的。如果经常这么做，则应该重新检查系统设计，看是否有另一种分解方案所得到的类，与其他类之间的耦合度会更小。私有成员和包级私有成员都是一个类的实现中的一部分，一般不会影响它的导出的API。然而如果这个类实现了serializable接口，这些域就有可能会被“泄露”到到导出API中。<br><br>对于公有类的的成员，当访问级别从包级私有变成保护级别时，会大大增强可访问性。受保护的成员是类的导出API的一部分，必须永远得到支持。导出的类的受保护成员也代表了该类对于某个实现细节的承诺。受保护的成员应该尽量少用。如果方法覆盖了超类中的一个方法，子类中的访问级别就不允许低于超累中的访问级别。这样可以确保任何可使用超类的实例的地方也都可以吃用子类的实例。<br><br>实例域决不能公有，如果域是非final的，或者是一个指向可变对象的final引用，那么一旦使这个域成为公有的，就放弃了对存储在这个域中的值进行限制的能力；这意味着，你也放弃了强制这个域不可变的能力。因此，包含公有可变域的类并不是线程安全的。<br><br>同样的建议也适用于静态域，除非通过公有的静态final域来暴露一些常量。这些域要么包含基本类型的值，要么包含指向不可变对象的引用。如果final域包含可变对象的引用，它便具有非final域的所有缺点。虽然本身不能被修改，但是它所引用的的对象却可以被修改——这会导致灾难性的后果。<br><br>总而言之，应该始终尽可能降低可访问性。除了公有静态final域的特殊情况外，公有类都不应该包含公有域。并且要确保公有静态final域所引用的对象都是不可变的。<br><br>&nbsp;</td><br></tr><br><tr><br><td><strong>STATIC</strong></td><br><td></td><br></tr><br><tr><br><td></td><br><td>static修饰符可以用来修饰域，方法，初始化块，类。<br><br><em>   static修饰域和方法<br>如果将域用static修饰，则每个类中只有一个这样的域。每个对象对所有的实例域都有一份自己的拷贝，而静态域则是共享的。静态变量用的相对较少，而静态常量用的相对较多。<br><br>静态方法是一种不能向对象实施操作的方法。可以认为静态方法是没有this参数的方法。因为静态方法不能操作对象，所以不能在静态方法中访问实例域，但是可以访问自身类中的静态域。静态方法可以被类调用，也可以被对象调用。在下面两种情况下使用静态方法：<br><br>1.  一个方法不需要访问对象状态，其所需参数都是通过显式参数提供。<br>2.  一个方法只需要访问类的静态域。<br>静态方法可以用来做静态工厂方法，代替构造器。和静态域配合可以实现单例模式。main函数也是一个静态方法。

</em>   static修饰初始化块<br>static修饰初始化块主要是有一个顺序问题。静态变量、静态初始化块、变量、初始化块、构造器，它们的初始化顺序以此是（静态变量、静态初始化块）&gt;（变量、初始化块）&gt;构造器。括号内的各项是由在代码中的顺序决定的。静态初始化块与静态方法一样，不能向对象实施操作，也就不能访问实例域和非静态方法。<br><br>在继承关系中，父类的静态变量和静态初始化块先执行，然后是子类的静态变量和静态初始化块执行，然后才是父类的变量，初始化块和构造器，最后是子类的变量，初始化块和构造器。<br><br><em>   static修饰类<br>如果一个类要被声明为static的，只有一种情况，就是静态成员类。静态成员类是最简单的一种嵌套类。最好把它看做是普通类，只是刚好声明在了另一个类的内部，它可以访问外部类的所有成员，包括那些声明为私有的成员。静态成员类是外部类的一个静态成员，与其他静态成员一样，也遵从同样的可访问性规则。<br>静态成员类的一种常见用法是作为公有的辅助类，仅当与它的外部类一起使用时才有意义。比如使用builder模式构建类的对象（effective java 2-2）。而私有静态成员类的一种常见用法是用来代表外部类所代表的对象的组件。<br><br>如果声明成员类不要求访问外围实例，就要始终把static修饰符放在它的声明中，使它成为静态成员类。如果省略了static修饰符，则每个实例都将包含一个额外的指向外围对象的引用。保存这份引用要消耗时间和空间，并会导致外围实例在符合垃圾回收时却仍然得以保留。如果在没有外围实例的情况下，也需要分配实例，就必须使用静态成员类，因为非静态成员类的实例必须要有一个外围实例。<br>静态成员类的一种常见用法是作为公有的辅助类，仅当与它的外部类一起使用时才有意义。比如使用builder模式构建类的对象（effective java 2-2）。而私有静态成员类的一种常见用法是用来代表外部类所代表的对象的组件。<br><br>如果声明成员类不要求访问外围实例，就要始终把static修饰符放在它的声明中，使它成为静态成员类。如果省略了static修饰符，则每个实例都将包含一个额外的指向外围对象的引用。保存这份引用要消耗时间和空间，并会导致外围实例在符合垃圾回收时却仍然得以保留。如果在没有外围实例的情况下，也需要分配实例，就必须使用静态成员类，因为非静态成员类的实例必须要有一个外围实例。<br><br>&nbsp;</em></td><br></tr><br><tr><br><td colspan="2"><strong>STRICTFP</strong></td><br></tr><br><tr><br><td></td><br><td>strictfp, 即 strict float point (精确浮点)。<br><br>strictfp 关键字可应用于类、接口或方法。使用 strictfp 关键字声明一个方法时，该方法中所有的float和double表达式都严格遵守FP-strict的限制,符合IEEE-754规范。当对一个类或接口使用 strictfp 关键字时，该类中的所有代码，包括嵌套类型中的初始设定值和代码，都将严格地进行计算。严格约束意味着所有表达式的结果都必须是 IEEE 754 算法对操作数预期的结果，以单精度和双精度格式表示。如果你想让你的浮点运算更加精确，而且不会因为不同的硬件平台所执行的结果不一致的话，可以用关键字strictfp.<br><br>&nbsp;</td><br></tr><br><tr><br><td colspan="2"><strong>SYNCHRONIZED</strong></td><br></tr><br><tr><br><td></td><br><td>如果一个方法使用synchronized修饰符，那么对象的锁将保护整个方法。也就是说，要调用该方法，线程必须获得内部的对象锁。代码示例：<br><pre class="lang:java decode:true ">public synchronized void method() {<br>    // TODO<br>}<br></pre><br>等价于<br><pre class="lang:java decode:true ">public void method() {<br>    this.intrinsicLock.lock();<br>    try {<br>        // TODO<br>    } finally {<br>        this.intrinsicLock.unlock();<br>    }<br>}<br></pre><br>synchronized修饰符还可以修饰一个代码块，当线程进入如下形式的阻塞：<br><pre class="lang:java decode:true ">synchronized(obj) {<br>    // TODO<br>}<br></pre><br>于是它获得了obj的锁。<br><br>可以看到使用synchronized修饰符编写代码要整洁的多。你必须了解每个对象都有一个内部锁，并且该锁有一个内部条件。由锁来管理那些试图进入synchronized方法的线程，由条件来管理那些调用wait的线程。<br><br>将静态方法声明为synchronized也适合法的。如果调用这种方法，该方法获得相关的类对象的内部锁。例如A类有一个静态同步的方法，那么当该方法被调用时，A.class对象被锁住。因此没有其他线程可以调用同一个类的这个或任何其他的同步静态方法。<br><br>最好不要使用synchronized修饰符。许多情况下你可以使用java.util.concurrent包中的一种机制，它会为你处理所有的加锁。过度的同步可能会导致性能降低，死锁，甚至不确定的行为<br><br>&nbsp;</td><br></tr><br><tr><br><td colspan="2"><strong>TRANSIENT</strong></td><br></tr><br><tr><br><td></td><br><td><br>transient可以修饰域。java提供了一个框架，用来将对象编码成字节流（序列化 serializing），并从字节流编码中重新构建对象（反序列化 deserializing）。transient修饰符表明这个实例域将从一个类的默认序列化形式中省略掉。 意思就是临时的，不会随对象一起序列化，所以在反序列化时这个修饰符修饰的域将被初始化为它们的默认值：对于对象引用，默认值为null；对于数值基本域，默认值为0；对于boolean域，默认值为false。如果 这些值不能被任何transient域所接受，你就必须提供一个readObject方法，它首先调用defaultReadObject，然后把这些transient域恢复为可接受的值。另一种方法是，这些域可以被延迟到第一次使用的时候才 真正的被初始化。</td><br></tr><br><tr><br><td colspan="2"><strong>VOLATILE</strong></td><br></tr><br><tr><br><td></td><br><td>volatile可以修饰域，保证任何一个线程在读取该域的时候都将看到最近刚刚写入的值，但是volatile修饰符不执行互斥访问。volatile修饰的域在每次被线程访问时，都强迫从共享内存中重新读取该域的值。而且当域值发生改变时，强迫线程将变化值写回到共享内存中。这样在任何一个时刻，两个不同的线程总是看到被修饰域的同一个值。<br><br>java语言规范中写到：为了获取最佳的速度，允许线程保存共享成员变量的私有拷贝，而且只有当线程进入或者离开同步代码块时才与共享成员变量的原始值对比。<br><br>这样当多个线程与同一个对象进行交互时，就必须要让线程及时得到共享成员变量的变化。而volatile修饰符的作用就是提示VM：对于被修饰成员变量不允许线程保存私有拷贝，而应让线程直接与共享成员变量交互。<br>在使用volatile修饰符是要小心下面情况：<br><pre class="lang:java decode:true ">//Broken - requires synchronization!<br>private static volatile int nextSerialNumber = 0 ;<br><br>public static int generateSerialNumber() {<br>    return nextSerialNumber ++;<br>}<br></pre><br>这个方法的目的是要确保每个调用都返回不同的值（只要不超过2的32次方个调用）。这个方法的状态只包含一个原子访问的域：nextSerialNumber，这个域的多有可能的值都是合法的。因此不需要任何同步来保护它的约束条件。然而，如果没有同步，这个方法仍然无法正常工作。<br><br>问题在于，增量操作符（++）不是一个原子操作。它在nextSerialNumber域中执行两项操作：首先读取它的值，然后写回一个新值，相当于原来的值再加上1。如果第二个线程在第一个线程读取旧值和写回一个新值期间读取这个域，第二个线程就会与第一个线程一起看到同一个值，并返回相同的序列号。这就是安全性失败（safety failure）：这个程序会计算出错误的结果。<br><br>修正generateSerialNumber方法的一种方法是在它的声明中增加synchronized修饰符。这样可以确保多个调用不会交叉存取，确保每个调用都会看到之前多有调用的效果。一旦这么做，就可以且应该从nextSerialNumber中删除volatile修饰符。为了让这个方法更可靠，要用long代替int，或者在nextSerialNumber快要重叠时抛出异常。<br><br>最好的方法是使用类AtomicLong，它是<em>*java.util.concurrent.atomic</em>的一部分。它所做的工作正是这里需要的。并且有可能比同步版的generateSerialNumber执行的更好：<br><pre class="lang:java decode:true ">private static final AtomicLong nextSerialNumber = new AtomicLong();<br><br>public static long generateSerialNumber() {<br>    return nextSerialNumber.getAndIncrement();<br>}<br></pre><br>当多个线程共享可变数据的时候，每个读或者写数据的线程都必须执行同步。如果没有同步，就无法保证一个线程所做的修改可以被另一个线程获知。未能同步共享可变数据会造成程序的活性失败（liveness failure）和安全失败（safety failure）。这样的失败是最难调试的。它们可能是间歇性的。而且与时间相关，程序的行为在不同的VM上可能根本不同。如果只需要线程之间的交互通信，而不需要互斥，volatile修饰符就是一种可以接受的同步形式，但是要正确使用它可能需要一些技巧。<br><br>当要访问的变量已经在synchronized代码块中，或者为常量时，不必使用该修饰符。<br><br>&nbsp;</td><br></tr><br></tbody><br></table><br></div><br><div style="color: #000000;font-family: 微软雅黑"><br><table><br><tbody><br><tr><br><td>Article Name:</td><br><td>JAVA修饰符</td><br></tr><br><tr><br><td>Author:</td><br><td>刘天昊</td><br></tr><br><tr><br><td>Email:</td><br><td>liutianhao.pro@gmail.com</td><br></tr><br></tbody><br></table><br></div>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Java/">Java</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-picture-about-vim" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/05/27/picture-about-vim/" class="article-date">
  	<time datetime="2014-05-27T05:14:56.000Z" itemprop="datePublished">2014-05-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/27/picture-about-vim/">一张图记住Vim快捷键</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>微博上的一张配图(感谢图片作者),可以设为壁纸,记住VIM的快捷键.关于Vim的使用,可以查看这里:<a href="http://www.grackertalk.com/%e4%bd%bf%e7%94%a8vim.html" title="使用VIM" target="_blank" rel="external">Vim使用教程</a></p>
<p><a href="http://www.grackertalk.com/wp-content/uploads/2014/05/vim快捷键.jpg" target="_blank" rel="external"><img src="http://www.grackertalk.com/wp-content/uploads/2014/05/vim快捷键.jpg" alt="vim快捷键"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Linux/">Linux</a><a class="article-category-link" href="/categories/Linux/开发工具推荐/">开发工具推荐</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Gracker
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/mobile.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>





<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>
</body>
</html>